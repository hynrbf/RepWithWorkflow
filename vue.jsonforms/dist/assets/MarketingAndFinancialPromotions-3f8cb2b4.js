import{bb as ee,bI as S,b1 as k,bd as j,j as te,aa as h,bc as T,l as G,D as I,bD as ie,I as oe,ag as ne,A as c,b3 as E,a3 as ae,am as se,bl as re,b4 as D,b6 as O,as as V,at as z,au as R,av as N,az as v,aA as M,o as y,m as le,n as s,w as r,J as de,aC as ue,aH as me,b9 as ce,P as a,x as f,r as P,q as w,y as F,aG as pe,a5 as ge,a6 as he,_ as ve}from"./index-9d6d511f.js";import{F as p,g as fe,M as be,a as Me,_ as Pe,b as Se,c as Ae}from"./MediaLabelComponent-feae136c.js";import{u as q}from"./useFinancialPromotionStore-bdfe7e68.js";import{_ as Oe}from"./GridCardTable-248623f7.js";import{_ as ye}from"./StatusLabelComponent.vue_vue_type_script_setup_true_lang-90f1f182.js";import{_ as ke}from"./DateTimeComponent-2c5db54c.js";const K=ee("mediaMarketingOutletStore",{state:()=>({mediaMarketingOutlet:void 0,mediaMarketingOutlets:[]}),getters:{mediaMarketingOutletsUnarchived({mediaMarketingOutlets:e}){return e.filter(t=>!t.archived)},mediaMarketingOutletsArchived({mediaMarketingOutlets:e}){return e.filter(t=>t.archived)}},actions:{setMediaMarketingOutlet(e){this.mediaMarketingOutlet=e},getMediaMarketingOutlet(e,t=!0){const o=this.mediaMarketingOutlets.find(n=>n.id===e);return t&&(this.mediaMarketingOutlet=o),o},appendMediaMarketingOutlet(e){return this.mediaMarketingOutlets=[...this.mediaMarketingOutlets,e],e},amendMediaMarketingOutlet(e,t){let o;return this.mediaMarketingOutlets=this.mediaMarketingOutlets.map(n=>n.id===e?(o={...n,...t},o):n),o},removeMediaMarketingOutlet(e){this.mediaMarketingOutlets=this.mediaMarketingOutlets.filter(t=>t.id!==e)},async fetchMediaMarketingOutletsAsync(){const e=S(),{fetchCustomerByEmailAsync:t}=e,{currentCustomer:o}=k(e);try{await t(o.value.email);const{mediaMarketingOutlets:n}=o.value;this.mediaMarketingOutlets=n}catch(n){return Promise.reject(n)}},async fetchMediaMarketingOutletAsync(e,t=!0){var l;const o=S(),{fetchCustomerByEmailAsync:n}=o,{currentCustomer:u}=k(o);try{await n(u.value.email);const d=(l=u.value.mediaMarketingOutlets)==null?void 0:l.find(m=>m.id===e);if(t&&(this.mediaMarketingOutlet=d),!d)throw new Error("Media Marketing not found.");return Promise.resolve(d)}catch(d){return Promise.reject(d)}},async createMediaMarketingOutletAsync(e,t=!0){const o=S(),{updateCustomerByEmailAsync:n}=o,{currentCustomer:u}=k(o);try{const l=u.value.email,d=u.value.mediaMarketingOutlets||[];if(!l)throw new Error("Email not defined.");const m={id:j(),createdAt:Date.now(),...e};return await n(l,{mediaMarketingOutlets:[...d,m]}),t&&this.appendMediaMarketingOutlet(m),Promise.resolve(m)}catch(l){return Promise.reject(l)}},async updateMediaMarketingOutletAsync(e,t,o=!0){const n=S(),{updateCustomerByEmailAsync:u}=n,{currentCustomer:l}=k(n);try{const d=l.value.email,m=l.value.mediaMarketingOutlets||[];if(!d)throw new Error("Email not defined.");let g;if(await u(d,{mediaMarketingOutlets:[...m.map(b=>b.id===e?g={...b,...t}:b)]}),!g)throw new Error("Media Marketing not found.");return o&&(this.mediaMarketingOutlet=g,this.amendMediaMarketingOutlet(g.id,g)),Promise.resolve(g)}catch(d){return Promise.reject(d)}},async deleteMediaMarketingOutletAsync(e,t=!0){const o=S(),{updateCustomerByEmailAsync:n}=o,{currentCustomer:u}=k(o);try{const l=u.value.email,d=u.value.mediaMarketingOutlets||[];if(!l)throw new Error("Email not defined.");return await n(l,{mediaMarketingOutlets:[...d.filter(m=>m.id!==e)]}),t&&this.removeMediaMarketingOutlet(e),Promise.resolve(!0)}catch(l){return Promise.reject(l)}}}}),Te=te({components:{ViewOutletModal:h(()=>v(()=>import("./ViewOutletModal-a487d5c5.js"),["assets/ViewOutletModal-a487d5c5.js","assets/ModalComponent.vue_vue_type_script_setup_true_lang-fe9b98ed.js","assets/index-9d6d511f.js","assets/index-982d5504.css","assets/DateTimeComponent-2c5db54c.js","assets/DateTimeComponent-c81dcb9c.css","assets/StaffLabelComponent-6b30f61e.js","assets/MediaLabelComponent-feae136c.js","assets/StatusLabelComponent.vue_vue_type_script_setup_true_lang-90f1f182.js","assets/MediaLabelComponent-567bf1c1.css"])),AddOutletModal:h(()=>v(()=>import("./AddOutletModal-dd8b1585.js"),["assets/AddOutletModal-dd8b1585.js","assets/ModalComponent.vue_vue_type_script_setup_true_lang-fe9b98ed.js","assets/index-9d6d511f.js","assets/index-982d5504.css","assets/OverlayLoader-e5a9021a.js","assets/OverlayLoader-bebe70db.css","assets/KendoOfficerSelectComponent-a3474693.js","assets/MediaLabelComponent-feae136c.js","assets/StatusLabelComponent.vue_vue_type_script_setup_true_lang-90f1f182.js","assets/MediaLabelComponent-567bf1c1.css","assets/MediaDropdown.vue_vue_type_script_setup_true_lang-ff62bd80.js"])),AddPromotionModal:h(()=>v(()=>import("./AddPromotionModal-561d078c.js"),["assets/AddPromotionModal-561d078c.js","assets/ModalComponent.vue_vue_type_script_setup_true_lang-fe9b98ed.js","assets/index-9d6d511f.js","assets/index-982d5504.css","assets/OverlayLoader-e5a9021a.js","assets/OverlayLoader-bebe70db.css","assets/KendoNumericInputComponent-fbc7c250.js","assets/KendoOfficerSelectComponent-a3474693.js","assets/MediaLabelComponent-feae136c.js","assets/StatusLabelComponent.vue_vue_type_script_setup_true_lang-90f1f182.js","assets/MediaLabelComponent-567bf1c1.css","assets/useFinancialPromotionStore-bdfe7e68.js","assets/GridCardTable-248623f7.js","assets/GridCardTable-d4d68ddc.css","assets/DateTimeComponent-2c5db54c.js","assets/DateTimeComponent-c81dcb9c.css","assets/AddPromotionModal-c884fa68.css"])),OutletActions:h(()=>v(()=>import("./OutletActions-21a25e7e.js"),["assets/OutletActions-21a25e7e.js","assets/SpinnerComponent-154f27a2.js","assets/index-9d6d511f.js","assets/index-982d5504.css","assets/SpinnerComponent-e29f1e6a.css","assets/OutletActions-9a8ae5ae.css"])),PromotionActions:h(()=>v(()=>import("./PromotionActions-1ab34cb0.js"),["assets/PromotionActions-1ab34cb0.js","assets/index-9d6d511f.js","assets/index-982d5504.css","assets/MediaLabelComponent-feae136c.js","assets/StatusLabelComponent.vue_vue_type_script_setup_true_lang-90f1f182.js","assets/MediaLabelComponent-567bf1c1.css","assets/PromotionActions-bc5837ef.css"])),ViewPromotionModal:h(()=>v(()=>import("./ViewPromotionModal-40964414.js"),["assets/ViewPromotionModal-40964414.js","assets/ModalComponent.vue_vue_type_script_setup_true_lang-fe9b98ed.js","assets/index-9d6d511f.js","assets/index-982d5504.css","assets/OverlayLoader-e5a9021a.js","assets/OverlayLoader-bebe70db.css","assets/MediaLabelComponent-feae136c.js","assets/StatusLabelComponent.vue_vue_type_script_setup_true_lang-90f1f182.js","assets/MediaLabelComponent-567bf1c1.css","assets/useFinancialPromotionStore-bdfe7e68.js","assets/file-xls-fcdae677.js","assets/file-xls-3b8704d3.css","assets/GridCardTable-248623f7.js","assets/GridCardTable-d4d68ddc.css","assets/DateTimeComponent-2c5db54c.js","assets/DateTimeComponent-c81dcb9c.css","assets/ViewPromotionModal-21c8ae35.css"])),MediaDropdown:h(()=>v(()=>import("./MediaDropdown-f5cbbb12.js"),["assets/MediaDropdown-f5cbbb12.js","assets/MediaDropdown.vue_vue_type_script_setup_true_lang-ff62bd80.js","assets/index-9d6d511f.js","assets/index-982d5504.css","assets/MediaLabelComponent-feae136c.js","assets/StatusLabelComponent.vue_vue_type_script_setup_true_lang-90f1f182.js","assets/MediaLabelComponent-567bf1c1.css"])),PromotionTableFilters:h(()=>v(()=>import("./PromotionTableFilters-56e024e2.js"),["assets/PromotionTableFilters-56e024e2.js","assets/index-9d6d511f.js","assets/index-982d5504.css"]))},data(){return{isLoading:!1,isShowSavingText:!1,moment:T,eventBus:G("$eventBusService"),eventBusFormSaved:G("$eventBusService"),currentTab:0,tabs:[{title:this.$t("marketingFinancialPage-mediaMarketing"),content:"mediaMarketing"},{title:this.$t("marketingFinancialPage-financialPromotions"),content:"financialPromotions"}],activeOutletTableGroup:"active",outletTableGroups:[{title:"Active",value:"active"},{title:"All",value:"all"}],isViewOutletModalVisible:!1,isAddOutletModalVisible:!1,isFetchingOutlet:!1,isAddingOutlet:!1,isArchivingOutlet:!1,archiveItem:"",activePromotionTableGroup:"pending",promotionTableGroups:[{title:"Pending",value:"pending"},{title:"Approved",value:"approved"},{title:"Rejected",value:"rejected"},{title:"All",value:"all"}],isViewPromotionModalVisible:!1,isAddPromotionModalVisible:!1,isFetchingPromotion:!1,isSavingPromotion:!1,currentPromotionValues:void 0,webScrapeService:I.resolve(ie.name),helperService:I.resolve(oe.name),updatingPromotionIds:[],promotionTableLoading:!1,marketingOutletTableLoading:!1,promotionTableSettings:{pageSize:10,pageNumber:1,skip:0,take:10,filters:{},sorts:[]},mediaMarketingTableSettings:{pageSize:10,pageNumber:1,skip:0,take:10,filters:{},sorts:[]},isSavingAlertOpened:!1,userSubmittedChangesService:I.resolve(ne.name)}},computed:{AppConstants(){return c},...E(S,["currentFirmName","currentCustomer"]),...E(K,["mediaMarketingOutlet","mediaMarketingOutlets","mediaMarketingOutletsArchived","mediaMarketingOutletsUnarchived"]),...E(q,["financialPromotion","financialPromotions","financialPromotionTotal"]),activeOutlet(){return this.mediaMarketingOutlet},outlets(){return this.orderBy(this.mediaMarketingOutlets,this.mediaMarketingTableSettings.sorts)},outletColumns(){return[{field:"name",title:"Account Name"},{field:"approved",title:"Approved",className:"text-center",sortable:!1},{field:"pending",title:"Pending",className:"text-center",sortable:!1},{field:"rejected",title:"Rejected",className:"text-center",sortable:!1},{field:"createdAt",title:"Most Recent Post",className:"text-center"},{field:"updatedAt",title:"Most Recent Approval",className:"text-center"},{field:"actions",title:" "}]},outletItems(){let e=this.outlets.filter(t=>!t.archived);return this.activeOutletTableGroup==="all"&&this.orderBy(this.mediaMarketingOutlets.filter(t=>t.archived),this.mediaMarketingTableSettings.sorts).map(t=>{e.push({...t,inactive:t.archived})}),e},activePromotion(){return this.financialPromotion},promotions(){return this.financialPromotions},promotionColumns(){const e=[{field:"media",title:"Media"},{field:"type",title:"Type"},{field:"contentOwner",title:"Content Owner"},{field:"moderator",title:"Moderator"}];switch(this.activePromotionTableGroup){case"pending":return[...e,{field:"approvalType",title:"Approval Type"},{field:"contentStatus",title:"Content Status"},{field:"approvalRequiredDate",title:"Approval Required Date"},{field:"actions",title:" "}];case"approved":return[...e,{field:"contentStatus",title:"Content Status"},{field:"dateApproved",title:"Date Approved"},{field:"dateLive",title:"Date Live"},{field:"actions",title:" "}];case"rejected":return[...e,{field:"contentStatus",title:"Content Status"},{field:"dateRejected",title:"Date Rejected"},{field:"dateLive",title:"Date Live"},{field:"actions",title:" "}];default:return[...e,{field:"contentStatus",title:"Content Status"},{field:"status",title:"Status"},{field:"date",title:"Date"},{field:"dateLive",title:"Date Live"},{field:"actions",title:" "}]}},promotionItems(){switch(this.activePromotionTableGroup){case"pending":return this.promotions.filter(e=>e.approvalStatus===p.Pending);case"approved":return this.promotions.filter(e=>e.approvalStatus===p.Approved);case"rejected":return this.promotions.filter(e=>e.approvalStatus===p.Rejected);default:return this.promotions.map(e=>(e.approvalStatus===p.Approved&&(e.approved=!0),e.approvalStatus===p.Rejected&&(e.rejected=!0),e.approvalStatus===p.Pending&&(e.pending=!0),e))}},promotionTypeOptions(){return[{label:`${this.currentFirmName} Products/Services`,value:"self"},{label:"Authorised Third Party Products/Services",value:"authorised-3rd-party"},{label:"Non-Authorised Third Party Products/Services",value:"non-authorised-3rd-party"}]},approvalTypeOptions(){return ae.getPostApprovalTypes().map(e=>({label:e,value:e}))},contentStatusOptions(){return[{label:"Live",value:"Live"},{label:"Not Live",value:"Not Live"}]}},created(){this.changeLifeCycleName(c.pageLifeCycleNameCreated)},async mounted(){this.eventBus.emit(c.bottomBarEnableEvent,!0),this.eventBus.on(c.formFieldPageLevelChangedEvent,()=>{this.userSubmittedChangesService.hasUserSubmittedChangesToRemoteApi=!1}),this.eventBusFormSaved.on(c.formSavedEvent,e=>{this.handleSaveAsync(e)}),this.changeLifeCycleName(c.pageLifeCycleNameMounted),this.userSubmittedChangesService.hasUserSubmittedChangesToRemoteApi=!1,this.fetchDataAsync()},unmounted(){this.isLoading=!1,this.eventBusFormSaved.off(c.formSavedEvent)},setup(){const e=se(),{changeLifeCycleName:t}=e;return{changeLifeCycleName:t}},methods:{orderBy:re,groupBy:fe,...D(S,["updateCustomerByEmailAsync"]),...D(K,["createMediaMarketingOutletAsync","updateMediaMarketingOutletAsync","fetchMediaMarketingOutletAsync","fetchMediaMarketingOutletsAsync","deleteMediaMarketingOutletAsync","appendMediaMarketingOutlet","amendMediaMarketingOutlet","getMediaMarketingOutlet","removeMediaMarketingOutlet"]),...D(q,["fetchFinancialPromotionAsync","fetchFinancialPromotionsAsync","deleteFinancialPromotionAsync","appendFinancialPromotion","amendFinancialPromotion","getFinancialPromotion","removeFinancialPromotion","setFinancialPromotion","saveOrUpdateFinancialPromotionAsync"]),async fetchDataAsync(){this.isLoading=!0,await Promise.all([this.fetchMediaMarketingOutletsAsync(),this.fetchPromotionsDataAsync()]),this.isLoading=!1},async fetchPromotionsDataAsync(){const{pageSize:e,pageNumber:t,filters:o,sorts:n}=this.promotionTableSettings;this.promotionTableLoading=!0;try{await this.fetchFinancialPromotionsAsync({pageSize:e,pageNumber:t,...o,sortPropertyName:O(n)?void 0:n[0].field,sortDirection:O(n)?void 0:n[0].dir})}catch{throw new Error("Something went wrong.")}finally{this.promotionTableLoading=!1}},selectTab(e){this.currentTab=e.selected},async addOutletAsync(e){const t=new be;t.id=j(),t.url=e.url,t.name=e.name,t.owner=e.owner,t.archived=!1,t.platform=e.platform,t.createdAt=T().unix(),t.updatedAt=T().unix(),this.isAddingOutlet=!0;try{await this.createMediaMarketingOutletAsync(t),this.isAddOutletModalVisible=!1,this.isAddingOutlet=!1,this.webScrapeService.registerMediaAsync(t.id,t.url,`${this.currentCustomer.id}`)}catch{}},viewOutlet(e){this.isViewOutletModalVisible=!0,this.isFetchingOutlet=!0,this.getMediaMarketingOutlet(e,!0),this.isFetchingOutlet=!1},async archiveOutlet(e,t){V({content:this.$t(t?"marketingFinancialPage-confirmArchiveOutlet":"marketingFinancialPage-confirmUnarchiveOutlet"),type:z.CONFIRM,onConfirm:()=>{this.isArchivingOutlet=!0,this.archiveItem=e,this.updateMediaMarketingOutletAsync(e,{archived:t,updatedAt:T().unix()}).then(()=>{this.isArchivingOutlet=!1})}})},getOutlet(e){return this.getMediaMarketingOutlet(e,!1)},removeOutlet(e){this.removeMediaMarketingOutlet(e),this.deleteMediaMarketingOutletAsync(e,!1)},async savePromotionAsync(e){var o,n,u,l;let t=new Me;e.id?t={...t,...e}:(t.id=j(),t.mediaOutlet=e.mediaOutlet,t.contentUrl=e.contentUrl,t.editorContent={content:(o=e.editorContent)==null?void 0:o.content,rawContent:(n=e.editorContent)==null?void 0:n.rawContent,suggestions:(u=e.editorContent)==null?void 0:u.suggestions,commentThreads:(l=e.editorContent)==null?void 0:l.commentThreads},t.owner=e.owner,t.moderator=e.moderator,t.approvalStatus=p.Pending,t.approvalDays=e.approvalDays,t.isLive=e.isLive,t.media=e.media||[],t.type=e.type,t.productType=(e.productType||[]).map(({label:d})=>d),t.remunerationMethod=e.remunerationMethod,t.createdAt=T().unix(),t.updatedAt=void 0),this.isSavingPromotion=!0;try{await this.saveOrUpdateFinancialPromotionAsync(t),this.webScrapeService.webScrapeAndRegisterAsync(`${this.currentCustomer.email}`,t.id)}catch{}finally{this.isSavingPromotion=!1,this.isAddPromotionModalVisible=!1,this.currentPromotionValues=void 0}},async viewPromotionAsync(e){this.setFinancialPromotion(),this.isViewPromotionModalVisible=!0,this.isFetchingPromotion=!0,await this.fetchFinancialPromotionAsync(e),this.isFetchingPromotion=!1},removePromotion(e){this.removeFinancialPromotion(e),this.deleteFinancialPromotionAsync(e,!1)},getFinancialTypeLabel(e){var t;return((t=this.promotionTypeOptions.find(o=>o.value===e))==null?void 0:t.label)||""},setUpdatingPromotionId(e){this.updatingPromotionIds.push(e)},unsetUpdatingPromotionId(e){this.updatingPromotionIds=this.updatingPromotionIds.filter(t=>t!==e)},approveRejectPost(e,t){V({title:"Confirm",content:t?"Do you wish to approve this post?":"Do you wish to reject this post?",confirmButtonText:t?"Confirm & Approve":"Confirm & Reject",confirmButtonThemeColor:t?"primary":"error",onConfirm:async()=>{const o=this.getFinancialPromotion(e);o||R({type:N.ERROR,content:"Something went wrong. Please try again later."});try{this.setUpdatingPromotionId(e),await this.saveOrUpdateFinancialPromotionAsync({...o,approvalStatus:t?p.Approved:p.Rejected}),R({type:N.SUCCESS,content:t?"Post Approved.":"Post Rejected."}),this.unsetUpdatingPromotionId(e)}catch{}}})},handleEdit(e){this.currentPromotionValues=e,this.isAddPromotionModalVisible=!0,this.isViewPromotionModalVisible=!1},async handleSaveAsync(e){this.isSavingAlertOpened||(e?V({title:"Confirm",content:"Marketing and Financial Promotions is incomplete. Are you sure you wish to proceed?",confirmButtonText:"Proceed",saveDetailsText:"Complete Now",type:z.SAVEDETAILS,width:390,onSaveDetails:()=>{this.isSavingAlertOpened=!1},onConfirm:async()=>{await this.saveInfoAsync(!0,e)},onCancel:()=>{this.isSavingAlertOpened=!1},onClose:()=>{this.isSavingAlertOpened=!1}}):V({title:"Confirm",content:"Please make sure the details are correct",confirmButtonText:"Confirm & Save",onConfirm:async()=>{await this.saveInfoAsync(!0)},onCancel:()=>{this.isSavingAlertOpened=!1},onClose:()=>{this.isSavingAlertOpened=!1}}),this.isSavingAlertOpened=!0)},async saveInfoAsync(e=!1,t=!1){const{email:o=""}=this.currentCustomer;this.isLoading=e,this.isShowSavingText=e,this.userSubmittedChangesService.hasUserSubmittedChangesToRemoteApi=!0,this.isSavingAlertOpened=!1,await this.updateCustomerByEmailAsync(o,{financialPromotions:this.financialPromotions}).then(()=>{e&&R({type:N.SUCCESS,content:this.$t("common-notification-saved"),interval:c.notificationPopupTimeOut}),this.isLoading=!1,this.isShowSavingText=!1,t&&setTimeout(()=>this.eventBus.emit(c.autoNextEvent),c.notificationPopupTimeOut)}).catch()},async promotionTableFilterAsync(e){const{values:t}=e;if(O(t))return;const o={};O(t.platform)||(o.mediaOutlets=t.platform.map(({value:n})=>n)),O(t.type)||(o.types=t.type.map(({value:n})=>n)),O(t.contentStatus)||(o.contentStatus=t.contentStatus.map(({value:n})=>n)),this.promotionTableSettings={...this.promotionTableSettings,filters:o,skip:0,pageNumber:1},await this.fetchPromotionsDataAsync()},async promotionTablePageChangedAsync(e){const{skip:t,take:o}=e.page,n=Math.ceil(t/o+1);this.promotionTableSettings={...this.promotionTableSettings,skip:t,pageNumber:n},await this.fetchPromotionsDataAsync()},async promotionTableSearchAsync(e){this.promotionTableSettings={...this.promotionTableSettings,filters:{...this.promotionTableSettings.filters,search:e},skip:0,pageNumber:1},await this.fetchPromotionsDataAsync()},async promotionTableSortAsync(e){this.promotionTableSettings={...this.promotionTableSettings,sorts:e.sort},await this.fetchPromotionsDataAsync()},marketingOutletSortAsync(e){this.marketingOutletTableLoading=!0,setTimeout(()=>{this.marketingOutletTableLoading=!1,this.mediaMarketingTableSettings.sorts=e.sort},300)},marketingOutletPageAsync(e){this.marketingOutletTableLoading=!0,setTimeout(()=>{this.marketingOutletTableLoading=!1,this.mediaMarketingTableSettings.skip=e.page.skip,this.mediaMarketingTableSettings.skip=e.page.skip},300)}}}),C=e=>(ge("data-v-6fa42404"),e=e(),he(),e),we={class:"font-size-xl text-primary mb-3"},Ce=["href"],_e={class:"row mb-3"},Ve={class:"col-8"},Fe=["href"],Le={class:"col-4 text-end"},Ie={class:"row mb-2"},Ee={class:"col text-center"},De=C(()=>a("h6",{class:"font-weight-medium mt-2"},"0",-1)),Re={class:"col text-center"},Ne=C(()=>a("h6",{class:"font-weight-medium mt-2"},"0",-1)),je={class:"col text-center"},Be=C(()=>a("h6",{class:"font-weight-medium mt-2"},"0",-1)),$e={class:"row font-size-xs text-center"},Ue={class:"col-lg-6 border-end"},Ge=C(()=>a("span",{class:"font-weight-medium font-color-dark"}," Most Recent Post ",-1)),ze={class:"col-lg-6"},qe=C(()=>a("span",{class:"font-weight-medium font-color-dark"}," Most Recent Approval ",-1)),Ke={class:"font-size-xl text-primary mb-3"},He=["href"],Je={class:"is-truncated"};function We(e,t,o,n,u,l){const d=ue,m=pe,g=me,b=Pe,_=ke,B=M("OutletActions"),L=ye,$=Oe,U=Se,H=Ae,J=M("PromotionActions"),W=M("PromotionTableFilters"),Q=ce,X=M("AddOutletModal"),Y=M("ViewOutletModal"),Z=M("AddPromotionModal"),x=M("ViewPromotionModal");return y(),le(de,null,[s(d,{"is-loading":e.isLoading,isShowSavingText:e.isShowSavingText},null,8,["is-loading","isShowSavingText"]),s(m),s(g,{title:e.$t("marketingFinancialPage-title"),routeName:e.helperService.removeStringSpacesThenSlash(e.AppConstants.marketingAndFinancialPromotionsRoute),class:"PageTitle"},null,8,["title","routeName"]),s(Q,{class:"TabStrip TabStrip--lined",selected:e.currentTab,tabs:e.tabs,onSelect:e.selectTab},{mediaMarketing:r(()=>[a("h2",we,f(e.$t("marketingFinancialPage-mediaMarketingOutlet")),1),a("p",null,f(e.$t("marketingFinancialPage-mediaMarketingDescription",{currentFirmName:e.currentFirmName})),1),s($,{class:"OutletTable mt-4",columns:e.outletColumns,items:e.outletItems.slice(e.mediaMarketingTableSettings.skip,e.mediaMarketingTableSettings.skip+e.mediaMarketingTableSettings.take),groups:e.outletTableGroups,"active-group":e.activeOutletTableGroup,"onUpdate:activeGroup":t[0]||(t[0]=i=>e.activeOutletTableGroup=i),"add-button-text":e.$t("marketingFinancialPage-addMediaMarketingOutlet"),onAdd:t[1]||(t[1]=i=>e.isAddOutletModalVisible=!0),pageable:e.outletItems.length>10,isSortable:"",sort:e.mediaMarketingTableSettings.sorts,skip:e.mediaMarketingTableSettings.skip,take:e.mediaMarketingTableSettings.take,total:e.outletItems.length,loading:e.marketingOutletTableLoading,handleSortChange:e.marketingOutletSortAsync,handlePageChange:e.marketingOutletPageAsync},{"cell-name":r(({item:i})=>[a("a",{href:i.url,target:"_blank"},[s(b,{id:i==null?void 0:i.platform,iconSize:32,text:i.name},null,8,["id","text"])],8,Ce)]),"cell-approved":r(()=>[P(" 0")]),"cell-pending":r(()=>[P(" 0")]),"cell-rejected":r(()=>[P(" 0")]),"cell-createdAt":r(({item:{createdAt:i}})=>[i?(y(),w(_,{key:0,value:e.moment(i*1e3).toDate(),class:"is-text-nowrap"},null,8,["value"])):F("",!0)]),"cell-updatedAt":r(({item:{updatedAt:i}})=>[i?(y(),w(_,{key:0,value:e.moment(i*1e3).toDate(),class:"is-text-nowrap"},null,8,["value"])):F("",!0)]),"cell-actions":r(({item:i})=>[s(B,{outlet:i,archiving:e.isArchivingOutlet,archiveItem:e.archiveItem,onView:e.viewOutlet,onArchive:e.archiveOutlet,onRemove:e.removeOutlet},null,8,["outlet","archiving","archiveItem","onView","onArchive","onRemove"])]),"card-content":r(({item:i})=>[a("div",_e,[a("div",Ve,[a("a",{href:i.url,target:"_blank",class:"link"},[s(b,{id:i==null?void 0:i.platform,"icon-size":"32",text:i.name},null,8,["id","text"])],8,Fe)]),a("div",Le,[s(B,{outlet:i,archiving:e.isArchivingOutlet,archiveItem:e.archiveItem,onView:e.viewOutlet,onArchive:e.archiveOutlet},null,8,["outlet","archiving","archiveItem","onView","onArchive"])])]),a("div",Ie,[a("div",Ee,[s(L,{status:"approved"}),De]),a("div",Re,[s(L,{status:"pending"}),Ne]),a("div",je,[s(L,{status:"rejected"}),Be])]),a("div",$e,[a("div",Ue,[Ge,i.createdAt?(y(),w(_,{key:0,value:i.createdAt,class:"is-text-nowrap"},null,8,["value"])):F("",!0)]),a("div",ze,[qe,i.updatedAt?(y(),w(_,{key:0,value:i.updatedAt,class:"is-text-nowrap"},null,8,["value"])):F("",!0)])])]),_:1},8,["columns","items","groups","active-group","add-button-text","pageable","sort","skip","take","total","loading","handleSortChange","handlePageChange"])]),financialPromotions:r(()=>[a("h2",Ke,f(e.$t("marketingFinancialPage-financialPromotions")),1),a("p",null,f(e.$t("marketingFinancialPage-financialPromotionsDescription",{currentFirmName:e.currentFirmName})),1),(y(),w($,{key:`promotion-table-${e.activePromotionTableGroup}`,class:"PromotionTable mt-4",columns:e.promotionColumns,items:e.promotionItems,groups:e.promotionTableGroups,"active-group":e.activePromotionTableGroup,"onUpdate:activeGroup":t[4]||(t[4]=i=>e.activePromotionTableGroup=i),"add-button-text":e.$t("marketingFinancialPage-addFinancialPromotion"),"no-switcher":"","no-actionbar":!1,"search-placeholder":"Search Content Owner, Moderator",pageable:"",isSortable:"",sort:e.promotionTableSettings.sorts,skip:e.promotionTableSettings.skip,take:e.promotionTableSettings.pageSize,total:e.financialPromotionTotal,loading:e.promotionTableLoading,handlePageChange:e.promotionTablePageChangedAsync,handleSortChange:e.promotionTableSortAsync,onAdd:t[5]||(t[5]=()=>{e.isAddPromotionModalVisible=!0,e.currentPromotionValues=void 0}),onFilter:e.promotionTableFilterAsync,onSearch:e.promotionTableSearchAsync},{"cell-media":r(({item:i})=>{var A;return[a("a",{href:i.contentUrl,target:"_blank",class:"link"},[s(b,{id:(A=e.getOutlet(i.mediaOutlet))==null?void 0:A.platform,"icon-only":"","icon-size":"32"},null,8,["id"])],8,He)]}),"cell-type":r(({item:i})=>[a("div",Je,f(e.getFinancialTypeLabel(i.type)),1)]),"cell-contentOwner":r(({item:i})=>[s(U,{id:i.owner,rounded:"full","text-truncated":"","text-only":""},null,8,["id"])]),"cell-moderator":r(({item:i})=>[s(U,{id:i.moderator,rounded:"full","text-truncated":""},null,8,["id"])]),"cell-approvalType":r(({item:i})=>[P(" Existing Post ")]),"cell-contentStatus":r(({item:i})=>[s(H,{live:i.isLive},null,8,["live"])]),"cell-approvalRequiredDate":r(({item:i})=>[P(f(e.moment((i.createdAt||0)*1e3).add(i.approvalDays||0,"days").calendar()),1)]),"cell-dateApproved":r(({item:i})=>[P(f(e.moment((i.approvedAt||0)*1e3).calendar()),1)]),"cell-dateRejected":r(({item:i})=>[P(f(e.moment((i.rejectedAt||0)*1e3).calendar()),1)]),"cell-actions":r(({item:i})=>[s(J,{promotion:i,disabled:e.updatingPromotionIds.includes(i.id),onView:e.viewPromotionAsync,onRemove:e.removePromotion,onApprove:t[2]||(t[2]=A=>e.approveRejectPost(A,!0)),onReject:t[3]||(t[3]=A=>e.approveRejectPost(A,!1))},null,8,["promotion","disabled","onView","onRemove"])]),"filter-fields":r(({form:i})=>[s(W,{form:i,type:e.activePromotionTableGroup},null,8,["form","type"])]),_:1},8,["columns","items","groups","active-group","add-button-text","sort","skip","take","total","loading","handlePageChange","handleSortChange","onFilter","onSearch"]))]),_:1},8,["selected","tabs","onSelect"]),s(X,{modelValue:e.isAddOutletModalVisible,"onUpdate:modelValue":t[6]||(t[6]=i=>e.isAddOutletModalVisible=i),saving:e.isAddingOutlet,onSubmit:e.addOutletAsync},null,8,["modelValue","saving","onSubmit"]),s(Y,{modelValue:e.isViewOutletModalVisible,"onUpdate:modelValue":t[7]||(t[7]=i=>e.isViewOutletModalVisible=i),outlet:e.activeOutlet},null,8,["modelValue","outlet"]),s(Z,{modelValue:e.isAddPromotionModalVisible,"onUpdate:modelValue":t[8]||(t[8]=i=>e.isAddPromotionModalVisible=i),"initial-values":e.currentPromotionValues,outlets:e.outlets,"promotion-type-options":e.promotionTypeOptions,saving:e.isSavingPromotion,onSubmit:e.savePromotionAsync},null,8,["modelValue","initial-values","outlets","promotion-type-options","saving","onSubmit"]),s(x,{modelValue:e.isViewPromotionModalVisible,"onUpdate:modelValue":t[9]||(t[9]=i=>e.isViewPromotionModalVisible=i),promotion:e.activePromotion,loading:e.isFetchingPromotion,onEdit:e.handleEdit},null,8,["modelValue","promotion","loading","onEdit"])],64)}const Qe=ve(Te,[["render",We],["__scopeId","data-v-6fa42404"]]),it=Object.freeze(Object.defineProperty({__proto__:null,default:Qe},Symbol.toStringTag,{value:"Module"}));export{it as M,K as u};
