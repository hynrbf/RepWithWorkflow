import{j as b,o as n,m as h,n as l,w as a,N as j,O as q,_ as R,bo as M,aa as S,az as w,D as H,I as K,cE as k,l as J,bl as $,A as B,ay as Q,aA as _,P as u,x as o,a0 as T,r as v,q as p,y as g,aB as X,J as Y,L as Z,bp as x,S as ee}from"./index-9d6d511f.js";import{_ as te}from"./KendoDetailPopupComponent-201e8196.js";import{_ as N}from"./GridCardTable-248623f7.js";import{E as ae}from"./EmployeeModel-2e630671.js";import"./ModalComponent.vue_vue_type_script_setup_true_lang-fe9b98ed.js";const se={class:"d-inline-flex gap-2"},ie=b({__name:"EmployeeGridActionButtons",emits:["view","edit"],setup(e,{emit:i}){return(y,r)=>{const c=j,m=q;return n(),h("div",se,[l(m,{type:"button",size:"small",rounded:"full",shape:"square","theme-color":"light",title:"View",class:"ActionButton",onClick:r[0]||(r[0]=D=>i("view"))},{default:a(()=>[l(c,{symbol:"eye",size:"20"})]),_:1}),l(m,{type:"button",size:"small",rounded:"full",shape:"square","theme-color":"light",title:"Edit",class:"ActionButton",onClick:r[1]||(r[1]=D=>i("edit"))},{default:a(()=>[l(c,{symbol:"edit-pen",size:"20"})]),_:1})])}}});const le=R(ie,[["__scopeId","data-v-a27cd1aa"]]),ne=b({name:"OrganizationalStructureList",components:{DynamicAvatar:M,EmployeeUserDetailAsync:S(()=>w(()=>import("./EmployeeUserDetail-01765209.js"),["assets/EmployeeUserDetail-01765209.js","assets/index-9d6d511f.js","assets/index-982d5504.css","assets/EmployeeRoleDetails-e6688bc5.js","assets/EmployeeRoleDetails-357a49f3.css"])),EmployeeTaskDetailsAsync:S(()=>w(()=>import("./EmployeeTaskDetails-7f4265e9.js"),["assets/EmployeeTaskDetails-7f4265e9.js","assets/index-9d6d511f.js","assets/index-982d5504.css","assets/EmployeeTaskDetails-80c14a27.css"])),EmployeeRoleDetailsAsync:S(()=>w(()=>import("./EmployeeRoleDetails-e6688bc5.js"),["assets/EmployeeRoleDetails-e6688bc5.js","assets/index-9d6d511f.js","assets/index-982d5504.css","assets/EmployeeRoleDetails-357a49f3.css"])),EmployeeGridActionButtons:le,GridCardTable:N},props:{employeesValues:{type:Array,default:()=>[]}},data(){return{helperService:H.resolve(K.name),defaultStaffAvatar:"default-staff-avatar.png",defaultLineManagerAvatar:"default-line-manager-avatar.png",gridData:[],isShowUserDetail:!1,isShowDetailDialog:!1,detailDialogTitle:"",detailDialogWidth:380,employeeAddEditDialogWidth:750,employee:new k,sortParams:[],skip:0,take:7,eventBus:J("$eventBusService")}},created(){this.gridData=this.formatEmployeeData();const e=$(this.gridData,this.sortParams);this.$emit("exportingPDF",this.columnsToPDF,e),this.eventBus.on(B.filterGridEvent,()=>{this.skip!=0&&(this.skip=0)})},unmounted(){this.eventBus.off(B.filterGridEvent)},watch:{employeesValues:{handler(){this.gridData=this.formatEmployeeData()},deep:!0}},computed:{ContactNumber(){return Q},Employee(){return k},EmployeeModel(){return ae},columns(){return[{field:"staffName",title:"Staff Name",width:200},{field:"primaryRoleStr",title:"Role(s)",width:280},{field:"emailAddress",title:"Email Address",width:180},{field:"contactNumberStr",title:"Contact Number",width:160,sortable:!1},{field:"lineManagerName",title:"Line Manager",width:200},{field:"status",title:"Status",width:130},{field:"task",title:"Task(s)",width:80,sortable:!1},{field:"actions",title:" ",width:108,sortable:!1}]},columnsToPDF(){return this.columns.filter(e=>e.field!=="actions")}},methods:{orderBy:$,formatEmployeeData(){return this.employeesValues.map(e=>{var i,y,r,c,m;return{...e,staffName:`${e.firstName} ${e.lastName}`,primaryRoleStr:(i=e.primaryRole)==null?void 0:i.name,lineManagerName:`${((y=e.lineManager)==null?void 0:y.firstName)??""} ${((r=e.lineManager)==null?void 0:r.lastName)??""}`,contactNumberStr:(c=e.contactNumber)==null?void 0:c.number,status:e.employmentStatus,task:((m=e.tasks)==null?void 0:m.length)??0}})},emitEditEvent(e){this.employee=e,this.$emit("editUser",this.employee)},viewUser(e){this.isShowUserDetail=!0,this.employee=e,this.$emit("viewUser",this.employee)},findEmployeeById(e){return this.employeesValues.find(i=>i.id===e)??new k},closeViewUserModal(){this.isShowUserDetail=!1,this.employee=new k},getCount(e){return(e==null?void 0:e.length)??0},displayOtherRoles(e){this.employee=e,this.detailDialogTitle="Roles",this.isShowDetailDialog=!0},onTaskOpen(e){var i;e&&(this.employee=e,(i=this.employee.tasks)!=null&&i.length&&(this.detailDialogTitle="Tasks",this.isShowDetailDialog=!0))},getPrimaryRoleStyleClass(e){return e?e.isModified?"modified":e.isFcaAuthorised?"authorised":"":""},getStatusPillColor(e){return e==="Active"?"good-status-pill":e==="Onboarding"?"warning-status-pill":"bad-status-pill"},handleSort(e){this.sortParams=e.sort},handlePage(e){this.skip=e.page.skip,this.take=e.page.take}}});const oe=["onClick"],re={class:"email-cell-text"},de={class:"contact-number-cell-text"},ue={key:0},ce=u("span",null,"Â ",-1),me=[ce],pe={key:0,class:"d-flex justify-content-center"},ge=["onClick"];function he(e,i,y,r,c,m){var P;const D=M,A=Z,V=x,z=_("EmployeeGridActionButtons"),U=N,W=_("EmployeeUserDetailAsync"),C=te,L=_("DynamicAvatar"),O=ee,G=_("EmployeeRoleDetailsAsync"),I=_("EmployeeTaskDetailsAsync");return n(),h(Y,null,[l(U,{class:"mt-4",id:"organizational-structure-list",isSortable:"",columns:e.columns,items:e.orderBy(e.gridData,e.sortParams).slice(e.skip,e.skip+e.take),noToolbar:!0,centerAlignedColumnHeaders:["status","task"],sort:e.sortParams,handleSortChange:e.handleSort,handlePageChange:e.handlePage,pageable:!0,skip:e.skip,take:e.take,total:((P=e.gridData)==null?void 0:P.length)??0},{"cell-staffName":a(({item:{staffName:t,img_id:s}})=>[l(D,{rounded:"full",type:"image",class:"staff-name-cell",imageSrc:s,imageAlt:s,text:t},{text:a(({text:d})=>[u("span",null,o(d),1)]),_:2},1032,["imageSrc","imageAlt","text"])]),"cell-primaryRoleStr":a(({item:t})=>[t!=null&&t.primaryRoleStr?(n(),h("div",{key:0,class:"roles-cell",onClick:s=>e.displayOtherRoles(t)},[l(A,{class:T(["tail-truncated-text",e.getPrimaryRoleStyleClass((t==null?void 0:t.primaryRole)??void 0)])},{default:a(()=>[v(o(t==null?void 0:t.primaryRoleStr),1)]),_:2},1032,["class"]),e.getCount((t==null?void 0:t.otherRoles)??void 0)?(n(),p(A,{key:0,class:"remaining-count"},{default:a(()=>[v(" +"+o(e.getCount((t==null?void 0:t.otherRoles)??void 0)),1)]),_:2},1024)):g("",!0)],8,oe)):g("",!0)]),"cell-emailAddress":a(({item:{emailAddress:t}})=>[u("span",re,o(t),1)]),"cell-contactNumber.number":a(({item:{contactNumber:t}})=>[u("span",de,o(t==null?void 0:t.dialCode)+" "+o(t==null?void 0:t.number),1)]),"cell-lineManager":a(({item:t})=>{var s,d,f,E;return[t!=null&&t.lineManager?(n(),p(D,{key:1,rounded:"full",type:"image",class:"staff-name-cell",imageSrc:(s=t==null?void 0:t.lineManager)==null?void 0:s.img_id,imageAlt:(d=t==null?void 0:t.lineManager)==null?void 0:d.img_id,text:`${(f=t==null?void 0:t.lineManager)==null?void 0:f.firstName} ${(E=t==null?void 0:t.lineManager)==null?void 0:E.lastName}`},{text:a(({text:F})=>[u("span",null,o(F),1)]),_:2},1032,["imageSrc","imageAlt","text"])):(n(),h("div",ue,me))]}),"cell-status":a(({item:{employmentStatus:t}})=>[t?(n(),h("div",pe,[l(V,{class:T(["employment-status",e.getStatusPillColor(t)])},{default:a(()=>[v(o(t),1)]),_:2},1032,["class"])])):g("",!0)]),"cell-task":a(({item:t})=>{var s,d,f;return[t?(n(),h("div",{key:0,class:"tasks-cell",onClick:E=>e.onTaskOpen(t)},[u("span",{style:X({textDecoration:(s=t==null?void 0:t.tasks)!=null&&s.length?"underline":"none",cursor:(d=t==null?void 0:t.tasks)!=null&&d.length?"pointer":"default"})},o(((f=t==null?void 0:t.tasks)==null?void 0:f.length)??0),5)],8,ge)):g("",!0)]}),"cell-actions":a(({item:t})=>[l(z,{onView:s=>e.viewUser(t),onEdit:s=>e.emitEditEvent(t)},null,8,["onView","onEdit"])]),_:1},8,["columns","items","sort","handleSortChange","handlePageChange","skip","take","total"]),e.isShowUserDetail?(n(),p(C,{key:0,width:e.employeeAddEditDialogWidth,onClose:e.closeViewUserModal},{content:a(()=>[l(W,{employee:e.employee,dialogWidth:e.employeeAddEditDialogWidth},null,8,["employee","dialogWidth"])]),_:1},8,["width","onClose"])):g("",!0),e.isShowDetailDialog?(n(),p(C,{key:1,width:e.detailDialogWidth,title:e.detailDialogTitle,onClose:i[0]||(i[0]=t=>e.isShowDetailDialog=!1)},{content:a(()=>[l(O,{orientation:"vertical",gap:10,align:{horizontal:"center",vertical:"top"}},{default:a(()=>{var t,s;return[u("div",null,[l(L,{size:"large",type:"image",rounded:"full",customStyle:{flexBasis:"60px",height:"60px"},imageSrc:(t=e.employee)==null?void 0:t.img_id,imageAlt:(s=e.employee)==null?void 0:s.img_id},null,8,["imageSrc","imageAlt"])]),l(A,{class:"detail-dialog-employee-name"},{default:a(()=>[v(o(e.employee.firstName)+" "+o(e.employee.lastName),1)]),_:1})]}),_:1}),e.detailDialogTitle==="Roles"?(n(),p(G,{key:0,employee:e.employee,dialogWidth:e.detailDialogWidth},null,8,["employee","dialogWidth"])):(n(),p(I,{key:1,employee:e.employee,dialogWidth:e.detailDialogWidth},null,8,["employee","dialogWidth"]))]),_:1},8,["width","title"])):g("",!0)],64)}const ve=R(ne,[["render",he]]);export{ve as default};
