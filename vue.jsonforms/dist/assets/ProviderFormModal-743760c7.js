import{j as ge,D as U,af as Ae,C as be,G as D,I as _e,am as ye,aW as Ce,A as I,aX as Ne,aa as he,az as Te,Z as W,o as Re,q as Se,w as o,n as i,H as a,S,W as G,r as O,x as H,P as we,aj as Fe,L as Pe,a$ as Oe,aJ as Ve,aK as Le,aL as De,aM as Ie,Q as xe,cM as Me,aO as Ee,O as qe,aT as je,aU as ke,bu as Ke}from"./index-9d6d511f.js";const ze={class:"text-right"},x=!1,$e=ge({__name:"ProviderFormModal",props:{provider:{},isEditMode:{type:Boolean},saving:{type:Boolean}},emits:["submit","requestToComplete"],setup(Q,{emit:M}){const X=Q,E=U.resolve(Ae.name),{provider:e,isEditMode:V}=be(X),w=D();let C=new Fe,F=D(!1),q=D(!1);const j=U.resolve(_e.name),Z=ye(),{changeLifeCycleName:k}=Z;Ce(()=>{k(I.pageLifeCycleNameCreated),ie()}),Ne(()=>{k(I.pageLifeCycleNameMounted)});const Y=()=>{var s,t;M("submit",{...(e==null?void 0:e.value)||{}}),(t=(s=w==null?void 0:w.value)==null?void 0:s.$el)==null||t.requestSubmit()},ee=()=>{M("requestToComplete",{...(e==null?void 0:e.value)||{}})},n=s=>`${I.providersRoute}${s}`.replace(/\s+/g,"").replace("/",""),ae=()=>{var s;(s=e==null?void 0:e.value)!=null&&s.details&&(e.value.details.isTradingSameAsRegisteredAddress=!e.value.details.isTradingSameAsRegisteredAddress,e.value.details.isTradingSameAsRegisteredAddress?e.value.details.tradingAddress=e.value.details.registeredAddress??"":e.value.details.tradingAddress="")},te=async s=>{var c;const t=await E.getFirmPraStatusAsync(s);F.value=t,(c=e==null?void 0:e.value)!=null&&c.details&&(e.value.details.praAuthorised=t)},se=s=>{var t;F.value=s,(t=e==null?void 0:e.value)!=null&&t.details&&(e.value.details.praAuthorised=s)},ie=()=>{var s;(s=e==null?void 0:e.value)!=null&&s.details&&(C.firmName=e.value.details.name,C.companyNumber=e.value.details.companyNumber,C.firmReferenceNumber=e.value.details.fcaFirmRefNo,V.value&&(F.value=e.value.details.praAuthorised??!1))},le=async s=>{var t;(t=e==null?void 0:e.value)!=null&&t.details&&(e.value.details.name=s.firmName,e.value.details.companyNumber=s.companyNumber,e.value.details.fcaFirmRefNo=s.firmReferenceNumber,e.value.details.registeredAddress=s.address,e.value.details.tradingAddress=s.tradingAddress,e.value.details.website=s.website,await ne(e.value.details.fcaFirmRefNo),C=s,q.value=!0,await te(e.value.details.fcaFirmRefNo??""))},ne=async s=>{var c;if(!s)return;const t=await E.getFirmAddressesDetailsAsync(s,"PPOB");if((t==null?void 0:t.length)>0){const L=t[0],_=JSON.parse(JSON.stringify(L));_["Phone Number"]&&_.country&&((c=e==null?void 0:e.value)!=null&&c.details)&&(e.value.details.contactNumber=await j.convertToContactNoAsync(_["Phone Number"],_.country))}},re=he(()=>Te(()=>import("./KendoFirmFinderComponent-9a5bf623.js"),["assets/KendoFirmFinderComponent-9a5bf623.js","assets/index-9d6d511f.js","assets/index-982d5504.css","assets/KendoFirmFinderComponent-d11737a3.css"])),de=W(()=>{var s;return(s=e==null?void 0:e.value)!=null&&s.details?e.value.details.name&&e.value.details.companyNumber&&e.value.details.fcaFirmRefNo&&e.value.details.emailAddress&&j.checkIfEmailFormatIsValid(e.value.details.emailAddress):!1}),oe=W(()=>{var s,t;return(s=e==null?void 0:e.value)!=null&&s.details&&((t=e==null?void 0:e.value)!=null&&t.representative)?e.value.details.name&&e.value.details.companyNumber&&e.value.details.fcaFirmRefNo&&e.value.details.registeredAddress&&e.value.details.tradingAddress&&e.value.details.emailAddress&&e.value.details.contactNumber&&e.value.representative.forename&&e.value.representative.surname&&e.value.representative.emailAddress&&e.value.representative.contactNumber&&e.value.representative.jobTitle&&e.value.details.productType&&e.value.details.productType.length>0:!1});return(s,t)=>{const c=Pe,L=Oe,_=Ve,ue=Le,K=De,z=Ie,P=xe,me=Me,pe=Ee,B=qe,ce=je,ve=ke,fe=Ke;return Re(),Se(fe,{class:"ModalFlexible",title:`${a(V)?"Edit":"Add New Provider"}`,"close-icon":!1},{default:o(()=>[i(ve,null,{default:o(()=>[i(ce,{ref_key:"formElement",ref:w},{default:o(()=>[i(a(S),{orientation:"vertical",gap:15,class:"col-md-12"},{default:o(()=>[i(G,null,{default:o(()=>{var m,p,v,f,g,A,r,l,$,J;return[i(c,{class:"flex-grow-1 section-title k-color-primary"},{default:o(()=>[O("Provider Details")]),_:1}),i(a(S),{orientation:"horizontal",align:{horizontal:"stretch"},style:{gap:"15px",display:"flex"}},{default:o(()=>{var u,d,N,h,T,R;return[i(a(re),{id:n("-provider.firmFinder"),companyNameLabel:"Provider Name",company:a(C),companyName:(d=(u=a(e))==null?void 0:u.details)==null?void 0:d.name,companyNumber:(h=(N=a(e))==null?void 0:N.details)==null?void 0:h.companyNumber,firmReferenceNumber:(R=(T=a(e))==null?void 0:T.details)==null?void 0:R.fcaFirmRefNo,onOnCompanyDetailUpdated:le},null,8,["id","company","companyName","companyNumber","firmReferenceNumber"]),i(L,{id:n("-providerIntroducerDetails.praAuthorised"),label:"PRA Authorised",class:"flex-grow-0",value:a(F),isSwitchAdjustMarginTop:a(q),name:"providerIntroducerDetails.praAuthorised",isRequired:!0,onOnValueChange:se},null,8,["id","value","isSwitchAdjustMarginTop","name"])]}),_:1}),i(_,{id:n("-provider.details.registeredAddress"),name:"provider.details.registeredAddress",class:"mt-2",label:"Registered Address",onOnValueChange:t[0]||(t[0]=u=>{var d;(d=a(e))!=null&&d.details&&(a(e).details.registeredAddress=u)}),value:(p=(m=a(e))==null?void 0:m.details)==null?void 0:p.registeredAddress,isValueReactive:!0,isDataLoadedCompletely:!x},null,8,["id","name","value","isDataLoadedCompletely"]),i(ue,{id:n("-provider.details.tradingAddress"),name:"provider.details.tradingAddress",label:"Trading Address",isUserModified:(f=(v=a(e))==null?void 0:v.details)==null?void 0:f.isTradingSameAsRegisteredAddress,value:(A=(g=a(e))==null?void 0:g.details)==null?void 0:A.tradingAddress,isChecked:(l=(r=a(e))==null?void 0:r.details)==null?void 0:l.isTradingSameAsRegisteredAddress,onOnValueChange:t[1]||(t[1]=u=>{var d;(d=a(e))!=null&&d.details&&(a(e).details.tradingAddress=u)}),onOnToggle:t[2]||(t[2]=u=>ae()),sameAsLabel:s.$t("same-as-registered-address"),isValueReactive:!0,isDataLoadedCompletely:!x},null,8,["id","name","isUserModified","value","isChecked","sameAsLabel","isDataLoadedCompletely"]),i(a(S),{orientation:"horizontal",align:{horizontal:"stretch"},style:{gap:"15px"}},{default:o(()=>{var u,d,N,h,T,R;return[i(K,{id:n("-provider.emailAddress"),label:"Email Address",name:"details.emailAddress",value:(d=(u=a(e))==null?void 0:u.details)==null?void 0:d.emailAddress,onOnValueChange:t[3]||(t[3]=y=>{var b;(b=a(e))!=null&&b.details&&(a(e).details.emailAddress=y,a(e).email=y)})},null,8,["id","value"]),i(z,{id:n("-provider.contactNumber"),label:"Contact Number",name:"details.contactNumber",value:(h=(N=a(e))==null?void 0:N.details)==null?void 0:h.contactNumber,onOnValueChange:t[4]||(t[4]=y=>{var b;(b=a(e))!=null&&b.details&&(a(e).details.contactNumber=y)})},null,8,["id","value"]),i(P,{id:n("-provider.website"),label:"Website",name:"details.website",placeholder:"www.domain.com",isRequired:!1,value:(R=(T=a(e))==null?void 0:T.details)==null?void 0:R.website,onOnValueChange:t[5]||(t[5]=y=>{var b;(b=a(e))!=null&&b.details&&(a(e).details.website=y)})},null,8,["id","value"])]}),_:1}),i(me,{id:n("-provider.details.productType"),name:"provider.details.productType",label:"Product Type",pageName:"Organisational Structure Chart",value:(J=($=a(e))==null?void 0:$.details)==null?void 0:J.productType,onOnValueChange:t[6]||(t[6]=u=>{var d;(d=a(e))!=null&&d.details&&(a(e).details.productType=u??[])}),isDataLoadedCompletely:!x,isValueReactive:!0},null,8,["id","value","isDataLoadedCompletely"])]}),_:1}),i(G,null,{default:o(()=>[i(c,{class:"flex-grow-1 section-title k-color-primary"},{default:o(()=>{var m,p;return[O(H((p=(m=a(e))==null?void 0:m.details)==null?void 0:p.name)+" Representative Details",1)]}),_:1}),i(a(S),{class:"my-3",orientation:"horizontal",align:{horizontal:"stretch"},style:{gap:"15px"}},{default:o(()=>{var m,p,v,f,g,A;return[i(pe,{id:n("-provider.title"),label:"Title",name:"representative.title",isRequired:!1,value:(p=(m=a(e))==null?void 0:m.representative)==null?void 0:p.title,onOnValueChange:t[7]||(t[7]=r=>{var l;(l=a(e))!=null&&l.representative&&(a(e).representative.title=r)})},null,8,["id","value"]),i(P,{id:n("-representative.forename"),label:"Forename(s)",name:"representative.forename",placeholder:"John",value:(f=(v=a(e))==null?void 0:v.representative)==null?void 0:f.forename,onOnValueChange:t[8]||(t[8]=r=>{var l;(l=a(e))!=null&&l.representative&&(a(e).representative.forename=r)})},null,8,["id","value"]),i(P,{id:n("-representative.surname"),label:"Surname",name:"representative.surname",placeholder:"Doe",value:(A=(g=a(e))==null?void 0:g.representative)==null?void 0:A.surname,onOnValueChange:t[9]||(t[9]=r=>{var l;(l=a(e))!=null&&l.representative&&(a(e).representative.surname=r)})},null,8,["id","value"])]}),_:1}),i(a(S),{orientation:"horizontal",align:{horizontal:"stretch"},style:{gap:"15px"}},{default:o(()=>{var m,p,v,f,g,A;return[i(K,{id:n("-representative.emailAddress"),label:"Email Address",name:"representative.emailAddress",value:(p=(m=a(e))==null?void 0:m.representative)==null?void 0:p.emailAddress,onOnValueChange:t[10]||(t[10]=r=>{var l;(l=a(e))!=null&&l.representative&&(a(e).representative.emailAddress=r)})},null,8,["id","value"]),i(z,{id:n("-representative.contactNumber"),label:"Contact Number",name:"representative.contactNumber",value:(f=(v=a(e))==null?void 0:v.representative)==null?void 0:f.contactNumber,onOnValueChange:t[11]||(t[11]=r=>{var l;(l=a(e))!=null&&l.representative&&(a(e).representative.contactNumber=r)})},null,8,["id","value"]),i(P,{id:n("-representative.jobTitle"),label:"Job Title",name:"representative.jobTitle",placeholder:"Job Title",value:(A=(g=a(e))==null?void 0:g.representative)==null?void 0:A.jobTitle,onOnValueChange:t[12]||(t[12]=r=>{var l;(l=a(e))!=null&&l.representative&&(a(e).representative.jobTitle=r)})},null,8,["id","value"])]}),_:1})]),_:1}),we("div",ze,[i(B,{style:{"margin-right":"10px","font-weight":"600"},type:"button","theme-color":"primary",onClick:ee,disabled:!de.value,"fill-mode":"outline"},{default:o(()=>[O(H(a(V)?"Save Changes":"Save & Add Provider"),1)]),_:1},8,["disabled"]),i(B,{type:"submit","theme-color":"primary",onClick:Y,disabled:!oe.value},{default:o(()=>[O(" Request Provider to Complete Details ")]),_:1},8,["disabled"])])]),_:1})]),_:1},512)]),_:1})]),_:1},8,["title"])}}});export{$e as default};
