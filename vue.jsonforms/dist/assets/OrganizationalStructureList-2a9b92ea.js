import{j as b,o as l,m as p,n,w as a,N as j,O as q,_ as R,bo as M,aa as w,az as C,D as H,I as K,cE as v,l as J,bl as $,A as B,ay as Q,aA as _,P as u,x as o,a0 as T,r as y,q as h,y as m,aB as X,J as Y,L as Z,bp as x,S as tt}from"./index-9d6d511f.js";import{_ as et}from"./KendoDetailPopupComponent-201e8196.js";import{_ as N}from"./GridCardTable-248623f7.js";import{E as at}from"./EmployeeModel-2e630671.js";import"./ModalComponent.vue_vue_type_script_setup_true_lang-fe9b98ed.js";const st={class:"d-inline-flex gap-2"},it=b({__name:"GridActionButtons",emits:["view","edit"],setup(t,{emit:i}){return(D,r)=>{const c=j,g=q;return l(),p("div",st,[n(g,{type:"button",size:"small",rounded:"full",shape:"square","theme-color":"light",title:"View",class:"ActionButton",onClick:r[0]||(r[0]=k=>i("view"))},{default:a(()=>[n(c,{symbol:"eye",size:"20"})]),_:1}),n(g,{type:"button",size:"small",rounded:"full",shape:"square","theme-color":"light",title:"Edit",class:"ActionButton",onClick:r[1]||(r[1]=k=>i("edit"))},{default:a(()=>[n(c,{symbol:"edit-pen",size:"20"})]),_:1})])}}});const nt=R(it,[["__scopeId","data-v-8195ce38"]]),lt=b({name:"OrganizationalStructureList",components:{DynamicAvatar:M,UserDetailAsync:w(()=>C(()=>import("./UserDetail-648db1b0.js"),["assets/UserDetail-648db1b0.js","assets/index-9d6d511f.js","assets/index-982d5504.css","assets/RoleDetails-20b7bca2.js","assets/RoleDetails-9e14d695.css"])),TaskDetailsAsync:w(()=>C(()=>import("./TaskDetails-f39e5872.js"),["assets/TaskDetails-f39e5872.js","assets/index-9d6d511f.js","assets/index-982d5504.css","assets/TaskDetails-e9dd94f4.css"])),RoleDetailsAsync:w(()=>C(()=>import("./RoleDetails-20b7bca2.js"),["assets/RoleDetails-20b7bca2.js","assets/index-9d6d511f.js","assets/index-982d5504.css","assets/RoleDetails-9e14d695.css"])),GridActionButtons:nt,GridCardTable:N},props:{employeesValues:{type:Array,default:()=>[]}},data(){return{helperService:H.resolve(K.name),defaultStaffAvatar:"default-staff-avatar.png",defaultLineManagerAvatar:"default-line-manager-avatar.png",gridData:[],isShowUserDetail:!1,isShowDetailDialog:!1,detailDialogTitle:"",detailDialogWidth:380,employeeAddEditDialogWidth:750,employee:new v,sortParams:[],skip:0,take:7,eventBus:J("$eventBusService")}},created(){this.gridData=this.formatEmployeeData();const t=$(this.gridData,this.sortParams);this.$emit("exportingPDF",this.columnsToPDF,t),this.eventBus.on(B.filterGridEvent,()=>{this.skip!=0&&(this.skip=0)})},unmounted(){this.eventBus.off(B.filterGridEvent)},watch:{employeesValues:{handler(){this.gridData=this.formatEmployeeData()},deep:!0}},computed:{ContactNumber(){return Q},Employee(){return v},EmployeeModel(){return at},columns(){return[{field:"staffName",title:"Staff Name",width:200},{field:"primaryRoleStr",title:"Role(s)",width:280},{field:"email",title:"Email Address",width:180},{field:"contactNumberStr",title:"Contact Number",width:160,sortable:!1},{field:"lineManagerName",title:"Line Manager",width:200},{field:"status",title:"Status",width:130},{field:"task",title:"Task(s)",width:80,sortable:!1},{field:"actions",title:" ",width:108,sortable:!1}]},columnsToPDF(){return this.columns.filter(t=>t.field!=="actions")}},methods:{orderBy:$,formatEmployeeData(){return this.employeesValues.map(t=>{var i,D,r,c,g;return{...t,staffName:`${t.firstName} ${t.lastName}`,primaryRoleStr:(i=t.primaryRole)==null?void 0:i.name,lineManagerName:`${((D=t.lineManager)==null?void 0:D.firstName)??""} ${((r=t.lineManager)==null?void 0:r.lastName)??""}`,contactNumberStr:(c=t.contactNumber)==null?void 0:c.number,status:t.employmentStatus,task:((g=t.tasks)==null?void 0:g.length)??0}})},emitEditEvent(t){this.employee=t,this.$emit("editUser",this.employee)},viewUser(t){this.isShowUserDetail=!0,this.employee=t,this.$emit("viewUser",this.employee)},findEmployeeById(t){return this.employeesValues.find(i=>i.id===t)??new v},closeViewUserModal(){this.isShowUserDetail=!1,this.employee=new v},getCount(t){return(t==null?void 0:t.length)??0},displayOtherRoles(t){this.employee=t,this.detailDialogTitle="Roles",this.isShowDetailDialog=!0},onTaskOpen(t){var i;t&&(this.employee=t,(i=this.employee.tasks)!=null&&i.length&&(this.detailDialogTitle="Tasks",this.isShowDetailDialog=!0))},getPrimaryRoleStyleClass(t){return t?t.isModified?"modified":t.isFcaAuthorised?"authorised":"":""},getStatusPillColor(t){return t==="Active"?"good-status-pill":t==="Onboarding"?"warning-status-pill":"bad-status-pill"},handleSort(t){this.sortParams=t.sort},handlePage(t){this.skip=t.page.skip,this.take=t.page.take}}});const ot=["onClick"],rt={class:"email-cell-text"},dt={class:"contact-number-cell-text"},ut={key:0},ct=u("span",null,"Â ",-1),gt=[ct],ht={key:0,class:"d-flex justify-content-center"},mt=["onClick"];function pt(t,i,D,r,c,g){var P;const k=M,A=Z,V=x,z=_("GridActionButtons"),U=N,W=_("UserDetailAsync"),E=et,L=_("DynamicAvatar"),O=tt,G=_("RoleDetailsAsync"),I=_("TaskDetailsAsync");return l(),p(Y,null,[n(U,{class:"mt-4",id:"organizational-structure-list",isSortable:"",columns:t.columns,items:t.orderBy(t.gridData,t.sortParams).slice(t.skip,t.skip+t.take),noToolbar:!0,centerAlignedColumnHeaders:["status","task"],sort:t.sortParams,handleSortChange:t.handleSort,handlePageChange:t.handlePage,pageable:!0,skip:t.skip,take:t.take,total:((P=t.gridData)==null?void 0:P.length)??0},{"cell-staffName":a(({item:{staffName:e,img_id:s}})=>[n(k,{rounded:"full",type:"image",class:"staff-name-cell",imageSrc:s,imageAlt:s,text:e},{text:a(({text:d})=>[u("span",null,o(d),1)]),_:2},1032,["imageSrc","imageAlt","text"])]),"cell-primaryRoleStr":a(({item:e})=>[e!=null&&e.primaryRoleStr?(l(),p("div",{key:0,class:"roles-cell",onClick:s=>t.displayOtherRoles(e)},[n(A,{class:T(["tail-truncated-text",t.getPrimaryRoleStyleClass((e==null?void 0:e.primaryRole)??void 0)])},{default:a(()=>[y(o(e==null?void 0:e.primaryRoleStr),1)]),_:2},1032,["class"]),t.getCount((e==null?void 0:e.otherRoles)??void 0)?(l(),h(A,{key:0,class:"remaining-count"},{default:a(()=>[y(" +"+o(t.getCount((e==null?void 0:e.otherRoles)??void 0)),1)]),_:2},1024)):m("",!0)],8,ot)):m("",!0)]),"cell-emailAddress":a(({item:{emailAddress:e}})=>[u("span",rt,o(e),1)]),"cell-contactNumber.number":a(({item:{contactNumber:e}})=>[u("span",dt,o(e==null?void 0:e.dialCode)+" "+o(e==null?void 0:e.number),1)]),"cell-lineManager":a(({item:e})=>{var s,d,f,S;return[e!=null&&e.lineManager?(l(),h(k,{key:1,rounded:"full",type:"image",class:"staff-name-cell",imageSrc:(s=e==null?void 0:e.lineManager)==null?void 0:s.img_id,imageAlt:(d=e==null?void 0:e.lineManager)==null?void 0:d.img_id,text:`${(f=e==null?void 0:e.lineManager)==null?void 0:f.firstName} ${(S=e==null?void 0:e.lineManager)==null?void 0:S.lastName}`},{text:a(({text:F})=>[u("span",null,o(F),1)]),_:2},1032,["imageSrc","imageAlt","text"])):(l(),p("div",ut,gt))]}),"cell-status":a(({item:{employmentStatus:e}})=>[e?(l(),p("div",ht,[n(V,{class:T(["employment-status",t.getStatusPillColor(e)])},{default:a(()=>[y(o(e),1)]),_:2},1032,["class"])])):m("",!0)]),"cell-task":a(({item:e})=>{var s,d,f;return[e?(l(),p("div",{key:0,class:"tasks-cell",onClick:S=>t.onTaskOpen(e)},[u("span",{style:X({textDecoration:(s=e==null?void 0:e.tasks)!=null&&s.length?"underline":"none",cursor:(d=e==null?void 0:e.tasks)!=null&&d.length?"pointer":"default"})},o(((f=e==null?void 0:e.tasks)==null?void 0:f.length)??0),5)],8,mt)):m("",!0)]}),"cell-actions":a(({item:e})=>[n(z,{onView:s=>t.viewUser(e),onEdit:s=>t.emitEditEvent(e)},null,8,["onView","onEdit"])]),_:1},8,["columns","items","sort","handleSortChange","handlePageChange","skip","take","total"]),t.isShowUserDetail?(l(),h(E,{key:0,width:t.employeeAddEditDialogWidth,onClose:t.closeViewUserModal},{content:a(()=>[n(W,{employee:t.employee,dialogWidth:t.employeeAddEditDialogWidth},null,8,["employee","dialogWidth"])]),_:1},8,["width","onClose"])):m("",!0),t.isShowDetailDialog?(l(),h(E,{key:1,width:t.detailDialogWidth,title:t.detailDialogTitle,onClose:i[0]||(i[0]=e=>t.isShowDetailDialog=!1)},{content:a(()=>[n(O,{orientation:"vertical",gap:10,align:{horizontal:"center",vertical:"top"}},{default:a(()=>{var e,s;return[u("div",null,[n(L,{size:"large",type:"image",rounded:"full",customStyle:{flexBasis:"60px",height:"60px"},imageSrc:(e=t.employee)==null?void 0:e.img_id,imageAlt:(s=t.employee)==null?void 0:s.img_id},null,8,["imageSrc","imageAlt"])]),n(A,{class:"detail-dialog-employee-name"},{default:a(()=>[y(o(t.employee.firstName)+" "+o(t.employee.lastName),1)]),_:1})]}),_:1}),t.detailDialogTitle==="Roles"?(l(),h(G,{key:0,employee:t.employee,dialogWidth:t.detailDialogWidth},null,8,["employee","dialogWidth"])):(l(),h(I,{key:1,employee:t.employee,dialogWidth:t.detailDialogWidth},null,8,["employee","dialogWidth"]))]),_:1},8,["width","title"])):m("",!0)],64)}const yt=R(lt,[["render",pt]]);export{yt as default};
