/*
 *             Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x5d63=['commentUpdated','delegate','resolveCommentThread','locale','editorDestroyed','_handleRemoveCommentModel','listenTo','resolvedAt','updateComment','add','delete','viewUid','count','_shouldCollapse','_config','render','commentViews','stopListening','change:isEditMode','refreshVisibleViews','set','maxThreadTotalWeight','ck-thread__comments','resolvedBy','_updateHasDirtyComment','element','editorReady','weight','_handleNewCommentModel','_handleInfoComment','hasDirtyComment','change:hasDirtyComment','resolvedCommentView','remove','from','visibleViews','equal','length','resolved','_collapsedCommentsView','focus','destroy','collapse','maxCommentsWhenCollapsed','_rearrangeExpand','CommentView','change:isResolved','setTemplate','isEditMode','some','_rearrangeCollapse','insert','createCollection','formatDateTime','authoredAt','comments','_model'];(function(_0x4dfcac,_0x5d6300){const _0x3b9975=function(_0x1a6006){while(--_0x1a6006){_0x4dfcac['push'](_0x4dfcac['shift']());}};_0x3b9975(++_0x5d6300);}(_0x5d63,0x1ab));const _0x3b99=function(_0x4dfcac,_0x5d6300){_0x4dfcac=_0x4dfcac-0x0;let _0x3b9975=_0x5d63[_0x4dfcac];return _0x3b9975;};import{View as _0xa37451}from'ckeditor5/src/ui';import{diff as _0x5cbd42,Collection as _0x3c3c36}from'ckeditor5/src/utils';import{getTranslation as _0x37979d}from'../../../utils/common-translations';import _0x1fc868 from'./collapsedcommentsview';export default class wt extends _0xa37451{constructor(_0x194d3f,_0x56af36,_0x20d657){super(_0x194d3f),this[_0x3b99('0x31')]('hasDirtyComment',!0x1),this[_0x3b99('0x31')](_0x3b99('0x9'),_0x56af36[_0x3b99('0x1b')][_0x3b99('0x9')]),this[_0x3b99('0x31')]('isActive',!0x1),this[_0x3b99('0x1c')]=_0x56af36,this['_config']=_0x20d657,this[_0x3b99('0x2d')]=this[_0x3b99('0x18')](),this[_0x3b99('0x7')]=this[_0x3b99('0x18')](),this[_0x3b99('0x4')]=null,this[_0x3b99('0xb')]=new _0x1fc868(_0x194d3f),this[_0x3b99('0xb')]['bind'](_0x3b99('0x29'))['to'](this,_0x3b99('0x9'),_0x4fff01=>_0x4fff01-this['_config'][_0x3b99('0xf')]);for(const _0x2d169d of _0x56af36[_0x3b99('0x1b')])this[_0x3b99('0x0')](_0x2d169d);this[_0x3b99('0x1')](),this['listenTo'](_0x56af36[_0x3b99('0x1b')],_0x3b99('0x26'),(_0x547e84,_0x40d8e5)=>{const _0x2be2f9=this['_calculatePosition'](_0x40d8e5);this[_0x3b99('0x9')]++,this[_0x3b99('0x0')](_0x40d8e5,_0x2be2f9),this[_0x3b99('0x30')]();}),this[_0x3b99('0x23')](_0x56af36[_0x3b99('0x1b')],'remove',(_0x139020,_0x2aa7ff)=>{this[_0x3b99('0x9')]--,this[_0x3b99('0x22')](_0x2aa7ff),this[_0x3b99('0x30')]();}),this[_0x3b99('0x23')](_0x56af36,_0x3b99('0x1d'),()=>this[_0x3b99('0x30')]()),this[_0x3b99('0x23')](_0x56af36,_0x3b99('0x12'),()=>this['_handleInfoComment']()),this['on']('change:isActive',()=>this[_0x3b99('0x30')]()),this['on'](_0x3b99('0x3'),()=>this['refreshVisibleViews']()),this[_0x3b99('0x13')]({'tag':'ul','attributes':{'class':[_0x3b99('0x33')]},'children':this[_0x3b99('0x7')]});}get[_0x3b99('0x2a')](){return this[_0x3b99('0x1c')][_0x3b99('0x38')]>this[_0x3b99('0x2b')][_0x3b99('0x32')]&&!this['isActive']&&!this[_0x3b99('0x2')];}[_0x3b99('0x2c')](){super[_0x3b99('0x2c')](),this[_0x3b99('0x30')]();}['focus'](){this[_0x3b99('0x36')][_0x3b99('0xc')]();}['destroy'](){this[_0x3b99('0xb')][_0x3b99('0xd')]();for(const _0x1e19f3 of this[_0x3b99('0x2d')])_0x1e19f3['destroy']();super['destroy']();}[_0x3b99('0x30')](){this[_0x3b99('0x2a')]?this['_rearrangeCollapse']():this[_0x3b99('0x10')]();}['_handleNewCommentModel'](_0x12ad72,_0x34235c){const _0x4dfd8f=new this[(_0x3b99('0x2b'))][(_0x3b99('0x11'))](this[_0x3b99('0x20')],_0x12ad72,{'maxCommentCharsWhenCollapsed':this['_config']['maxCommentCharsWhenCollapsed'],'formatDateTime':this['_config']['formatDateTime'],'editorConfig':this[_0x3b99('0x2b')]['editorConfig']});_0x4dfd8f[_0x3b99('0x28')]=_0x12ad72['id'],_0x4dfd8f[_0x3b99('0x1e')]('removeComment')['to'](this),_0x4dfd8f[_0x3b99('0x1e')](_0x3b99('0x25'))['to'](this),_0x4dfd8f[_0x3b99('0x1e')](_0x3b99('0x1f'))['to'](this),_0x4dfd8f[_0x3b99('0x1e')](_0x3b99('0x37'))['to'](this),_0x4dfd8f['delegate'](_0x3b99('0x21'))['to'](this),this[_0x3b99('0x23')](_0x4dfd8f,_0x3b99('0x2f'),()=>this[_0x3b99('0x35')]()),this[_0x3b99('0x2d')][_0x3b99('0x26')](_0x4dfd8f,_0x34235c);}['_calculatePosition'](_0x55fb9e){const _0x1a5938=this[_0x3b99('0x1c')]['_findOptimalIndex'](_0x55fb9e);return this[_0x3b99('0x4')]?this[_0x3b99('0x4')][_0x3b99('0x1a')]>_0x55fb9e['authoredAt']?_0x1a5938-0x1:_0x1a5938:_0x1a5938-0x1;}[_0x3b99('0x1')](){if(this[_0x3b99('0x1c')][_0x3b99('0x34')]&&this[_0x3b99('0x1c')][_0x3b99('0x24')]){const _0x36f743={'id':_0x3b99('0xa'),'author':this[_0x3b99('0x1c')][_0x3b99('0x34')],'authoredAt':this[_0x3b99('0x1c')][_0x3b99('0x24')],'content':_0x37979d(this[_0x3b99('0x20')],'Marked\x20as\x20resolved'),'attributes':{}};this['resolvedCommentView']=new this[(_0x3b99('0x2b'))][(_0x3b99('0x11'))](this['locale'],_0x36f743,{'maxCommentCharsWhenCollapsed':this[_0x3b99('0x2b')]['maxCommentCharsWhenCollapsed'],'formatDateTime':this[_0x3b99('0x2b')][_0x3b99('0x19')],'editorConfig':this['_config']['editorConfig'],'isSystemComment':!0x0}),this[_0x3b99('0x2d')][_0x3b99('0x26')](this['resolvedCommentView'],this['_model']['_findOptimalIndex'](_0x36f743));}else this[_0x3b99('0x4')]&&(this['commentViews'][_0x3b99('0x5')](this['resolvedCommentView']),this[_0x3b99('0x4')]['destroy'](),this[_0x3b99('0x4')]=null);this[_0x3b99('0x30')]();}[_0x3b99('0x22')](_0x5d0a0e){const _0x475105=this['commentViews']['remove'](_0x5d0a0e['id']);this[_0x3b99('0x2e')](_0x475105),_0x475105[_0x3b99('0x14')]&&this['_updateHasDirtyComment'](),_0x475105['destroy']();}['_updateHasDirtyComment'](){this[_0x3b99('0x2')]=Array[_0x3b99('0x6')](this[_0x3b99('0x2d')])[_0x3b99('0x15')](_0x5442c9=>_0x5442c9[_0x3b99('0x14')]);}[_0x3b99('0x16')](){const _0xa4de6c=function(_0x44f1f6){const _0x476b6a=new _0x3c3c36();for(const _0x4b94aa of _0x44f1f6)_0x476b6a['add'](_0x4b94aa);return _0x476b6a;}(this['commentViews']),_0x5a4bed=this[_0x3b99('0xb')][_0x3b99('0x29')];for(let _0x9d3f8d=0x1;_0x9d3f8d<=_0x5a4bed;_0x9d3f8d++)_0xa4de6c[_0x3b99('0x5')](0x1);for(const _0x117ae7 of _0xa4de6c)_0x117ae7[_0x3b99('0xe')]();_0x5a4bed>0x0&&_0xa4de6c['add'](this['_collapsedCommentsView'],0x1),ss(_0x5cbd42(Array[_0x3b99('0x6')](this[_0x3b99('0x7')]),Array[_0x3b99('0x6')](_0xa4de6c)),this[_0x3b99('0x7')],_0xa4de6c);}[_0x3b99('0x10')](){ss(_0x5cbd42(Array[_0x3b99('0x6')](this[_0x3b99('0x7')]),Array[_0x3b99('0x6')](this['commentViews'])),this[_0x3b99('0x7')],this['commentViews']);for(const _0x4623e7 of this['visibleViews'])_0x4623e7['expand']();}}function ss(_0x27b620,_0x1768ef,_0x4049b3){let _0xbc5a7b=0x0;for(const _0x814dba of _0x27b620)switch(_0x814dba){case _0x3b99('0x17'):_0x1768ef[_0x3b99('0x26')](_0x4049b3['get'](_0xbc5a7b),_0xbc5a7b),_0xbc5a7b++;break;case _0x3b99('0x27'):_0x1768ef[_0x3b99('0x5')](_0xbc5a7b);break;case _0x3b99('0x8'):_0xbc5a7b++;}}