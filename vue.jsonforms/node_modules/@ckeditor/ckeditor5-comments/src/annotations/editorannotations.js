/*
 *             Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x51c3=['annotation','getByInnerView','from','view','_editorAnnotations','document','change:isFocused','set','editor','getRanges','get','map','editorannotations-invalid-source-callback','refresh','innerView','cancel','isCollapsed','refreshSelectedViews','change:range','editing','getOrderedSelectedAnnotations','EditorAnnotations','uiUpdate','blur','collection','model','focusTracker','isReadOnly','sort','range','selection','add','listenTo','fire','element','init','remove','hasDomSelection','containsRange','addSourceCollector','_dataCollectors','directChange','isEqual','delete','pluginName','_editorAnnotationsData'];(function(_0x39f55b,_0x51c33e){const _0x5330f0=function(_0x39fcce){while(--_0x39fcce){_0x39f55b['push'](_0x39f55b['shift']());}};_0x5330f0(++_0x51c33e);}(_0x51c3,0x157));const _0x5330=function(_0x39f55b,_0x51c33e){_0x39f55b=_0x39f55b-0x0;let _0x5330f0=_0x51c3[_0x39f55b];return _0x5330f0;};import{Plugin as _0x1c8180}from'ckeditor5/src/core';import{CKEditorError as _0x5dd79e}from'ckeditor5/src/utils';import{debounce as _0x28dfa2}from'lodash-es';import _0x2bd8ec from'./annotations';export default class k extends _0x1c8180{static get['requires'](){return[_0x2bd8ec];}static get[_0x5330('0x17')](){return _0x5330('0x0');}constructor(_0x46f423){super(_0x46f423),this[_0x5330('0x13')]=new Set(),this[_0x5330('0x1d')]=new Set();}[_0x5330('0xe')](){const _0x1d82f0=this[_0x5330('0x21')],_0x5d9e6a=_0x1d82f0[_0x5330('0x4')][_0x5330('0x1e')]['selection'],_0xdc33e8=_0x28dfa2(()=>this['refreshSelectedViews'](),0xa);_0x5d9e6a['on'](_0x5330('0x2b'),(_0x3d1781,_0x1a312a)=>{_0x1a312a[_0x5330('0x14')]&&(_0xdc33e8[_0x5330('0x28')](),this[_0x5330('0x2a')]());}),this[_0x5330('0xb')](_0x1d82f0[_0x5330('0x2c')][_0x5330('0x1c')][_0x5330('0x1e')],_0x5330('0x1f'),(_0x217355,_0xdc1d9c,_0x5f4316)=>{_0x5f4316&&_0xdc33e8();}),this[_0x5330('0xb')](_0x1d82f0['ui'][_0x5330('0x5')],'change:isFocused',(_0x3986b3,_0x242e4f,_0x39680f)=>{_0x39680f||_0x1d82f0[_0x5330('0x6')]||this['fire'](_0x5330('0x2'),{'isAnnotationTracked':_0x297a59=>this['_editorAnnotationsData']['has'](_0x297a59[_0x5330('0x27')])});}),this[_0x5330('0xb')](this[_0x5330('0x21')]['ui'],'update',()=>this[_0x5330('0xc')](_0x5330('0x1')));}['registerAnnotation'](_0x2dec73){if(this[_0x5330('0x1d')]['has'](_0x2dec73[_0x5330('0x1c')]))return;this[_0x5330('0x1d')][_0x5330('0xa')](_0x2dec73[_0x5330('0x1c')]),this[_0x5330('0x21')]['ui']['focusTracker'][_0x5330('0xa')](_0x2dec73[_0x5330('0x1c')][_0x5330('0xd')]);const _0x23b86b=this['editor']['plugins'][_0x5330('0x23')](_0x2bd8ec);this['listenTo'](_0x23b86b[_0x5330('0x3')],_0x5330('0xf'),(_0xeedea5,_0x23ba73)=>{this[_0x5330('0x21')]['ui']['focusTracker'][_0x5330('0xf')](_0x23ba73[_0x5330('0x1c')][_0x5330('0xd')]),this[_0x5330('0x1d')][_0x5330('0x16')](_0x23ba73['view']);});}[_0x5330('0x10')](){return this['editor'][_0x5330('0x2c')][_0x5330('0x1c')]['hasDomSelection'];}[_0x5330('0x12')](_0x46e72c){if('function'!=typeof _0x46e72c)throw new _0x5dd79e(_0x5330('0x25'));this[_0x5330('0x13')][_0x5330('0xa')](_0x46e72c);}[_0x5330('0x2a')](){this[_0x5330('0xc')](_0x5330('0x26'));}[_0x5330('0x2d')]({activeAnnotation:_0x5e085c,annotations:_0x352b37}){const _0x2f2d9b=[],_0x23f338=this[_0x5330('0x21')][_0x5330('0x4')]['document'][_0x5330('0x9')],_0x50c42b=Array[_0x5330('0x1b')](_0x23f338[_0x5330('0x22')]());for(const [_0x1addda,_0x447952]of this[_0x5330('0x18')]){const _0x55461f=_0x23181e(_0x447952),_0x10ea97=_0x352b37[_0x5330('0x1a')](_0x1addda);_0x55461f&&_0x10ea97&&_0x2f2d9b['push']({'annotation':_0x10ea97,'range':_0x55461f});}function _0x23181e(_0x329fe6){for(const _0x1ed227 of _0x329fe6)for(const _0x36d07d of _0x50c42b)if(_0x1ed227[_0x5330('0x11')](_0x36d07d,!_0x23f338[_0x5330('0x29')]))return _0x1ed227;return null;}return _0x2f2d9b[_0x5330('0x7')]((_0x960c70,_0x3a1280)=>{const _0x1b6ce8=_0x960c70[_0x5330('0x8')],_0x43f488=_0x3a1280[_0x5330('0x8')];if(!_0x1b6ce8[_0x5330('0x15')](_0x43f488)){if(_0x1b6ce8[_0x5330('0x11')](_0x43f488,!0x0))return 0x1;if(_0x43f488[_0x5330('0x11')](_0x1b6ce8,!0x0))return-0x1;}return _0x960c70['annotation']==_0x5e085c?-0x1:_0x3a1280[_0x5330('0x19')]==_0x5e085c?0x1:0x0;})[_0x5330('0x24')](_0x42c564=>_0x42c564[_0x5330('0x19')]);}get[_0x5330('0x18')](){const _0x16d4cc=new Map();for(const _0x58b70d of Array['from'](this[_0x5330('0x13')]))for(const [_0xcdd404,_0x3d9b16]of _0x58b70d())_0x16d4cc[_0x5330('0x20')](_0xcdd404,_0x3d9b16);return _0x16d4cc;}}