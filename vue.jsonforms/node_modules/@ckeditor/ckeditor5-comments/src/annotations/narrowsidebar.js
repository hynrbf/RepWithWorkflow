/*
 *             Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0xdbb6=['plugins','stopListening','clear','annotations','listenTo','stop','southArrowNorthWest','_selectedAnnotations','_showBalloon','create','find','element','isAttached','keydown','view','destroy','off','_attachToContainer','narrowsidebar-attach-already-attached','requires','narrowSidebar','_manuallyClosedAnnotationViews','northArrowSouthEast','refreshPositioning','_hideBalloon','_annotations','has','values','stopPropagation','EditorAnnotations','activeAnnotation','_refreshPositioning','init','hasDomSelection','_refreshPositioningDebounced','focus','change:height','delete','Esc','content','_editorAnnotations','narrowsidebar-detach-not-attached','detachFromDom','balloonPanelView','addAnnotation','mousedown','get','blur','add','set','isVisible','NarrowSidebar','defaultPositions','bind','preventDefault','contains','focusableElements','_updateBalloonPosition','_setSelectedAnnotations','register','resize','high','_attachListeners','setActiveAnnotation','from','target','detach','preventClosingBalloon','uiUpdate','low','locale','_annotationToNarrowView','refresh','southArrowNorth','_integrateWithEditorAnnotations','isDirty','_domEmitter','number','remove','esc','southArrowNorthEast','attach','_detachListeners','annotationType','cancel','context','_destroyEditorAnnotationsIntegration','length','change:container','first','bodyCollection','keyCode'];(function(_0x31adaa,_0xdbb601){const _0x4e1197=function(_0x4916ca){while(--_0x4916ca){_0x31adaa['push'](_0x31adaa['shift']());}};_0x4e1197(++_0xdbb601);}(_0xdbb6,0x134));const _0x4e11=function(_0x31adaa,_0xdbb601){_0x31adaa=_0x31adaa-0x0;let _0x4e1197=_0xdbb6[_0x31adaa];return _0x4e1197;};import{ContextPlugin as _0x4383e1,Context as _0x360811}from'ckeditor5/src/core';import _0x1d0aab from'./annotationsuis';import _0x525883 from'./sidebar';import _0x847a64 from'./view/annotationcounterbuttonview';import{BalloonPanelView as _0x35ae86,BodyCollection as _0x170d9e}from'ckeditor5/src/ui';import{CKEditorError as _0x46865d,DomEmitterMixin as _0x58cf32,keyCodes as _0x362211,Collection as _0x21be6e}from'ckeditor5/src/utils';import'../../theme/sidebar-narrow.css';import{debounce as _0x1a3432}from'lodash-es';import _0xe0d9e5 from'./editorannotations';export default class s extends _0x4383e1{static get[_0x4e11('0x4f')](){return[_0x525883,_0x1d0aab];}static get['pluginName'](){return _0x4e11('0x13');}constructor(_0xe94f49){super(_0xe94f49),this[_0x4e11('0x48')]=!0x1,this[_0x4e11('0x51')]=new Set(),this[_0x4e11('0x2c')]=Object[_0x4e11('0x45')](_0x58cf32),this[_0x4e11('0x27')]=new Map(),this['set']('activeAnnotation',null),this[_0x4e11('0x3f')]=null,this[_0x4e11('0x43')]=[],this[_0x4e11('0x8')]=new _0x21be6e(),this[_0x4e11('0x2')]=_0x1a3432(()=>{this[_0x4e11('0x5b')]();},0xfa,{'leading':!0x1});}[_0x4e11('0x0')](){this[_0x4e11('0x35')][_0x4e11('0x3c')][_0x4e11('0xe')](_0x1d0aab)[_0x4e11('0x1b')](_0x4e11('0x50'),this),this['bodyCollection']=new _0x170d9e(this[_0x4e11('0x35')][_0x4e11('0x26')]),this[_0x4e11('0xb')]=new _0x35ae86(this[_0x4e11('0x35')][_0x4e11('0x26')]),this['bodyCollection']['attachToDom'](),this[_0x4e11('0x3a')][_0x4e11('0x10')](this[_0x4e11('0xb')]);}[_0x4e11('0x31')](_0x44be61){this[_0x4e11('0x3f')]=_0x44be61;const _0x3e3b7e=this[_0x4e11('0x35')][_0x4e11('0x3c')]['get'](_0x525883),_0x2fc2fc=this[_0x4e11('0xb')];if(_0x3e3b7e[_0x4e11('0x55')]=_0x44be61,this[_0x4e11('0x48')])throw new _0x46865d(_0x4e11('0x4e'),this);this['isAttached']=!0x0,this[_0x4e11('0x40')](_0x3e3b7e,'set:container',()=>{this[_0x4e11('0x22')](),this[_0x4e11('0x40')](_0x3e3b7e,_0x4e11('0x38'),_0x11994f=>{_0x11994f[_0x4e11('0x4c')](),this[_0x4e11('0x31')](_0x44be61);});}),_0x3e3b7e[_0x4e11('0x4d')]({'viewClass':'ck-sidebar--narrow','spaceBetweenItems':0x5});const _0x41b600=_0x2a5262=>{const _0x76610d=new _0x847a64(this[_0x4e11('0x35')]['locale']);_0x3e3b7e[_0x4e11('0xc')](_0x2a5262,_0x76610d),this['_annotationToNarrowView'][_0x4e11('0x11')](_0x2a5262,_0x76610d),_0x76610d[_0x4e11('0x15')](_0x4e11('0x2b'),_0x4e11('0x33'),_0x4e11('0x2d'))['to'](_0x2a5262[_0x4e11('0x4a')],_0x4e11('0x2b'),'type',_0x4e11('0x37')),_0x76610d['on']('execute',()=>{this[_0x4e11('0x51')][_0x4e11('0x3e')](),_0x2fc2fc[_0x4e11('0x7')]['first']!==_0x2a5262[_0x4e11('0x4a')]?(this[_0x4e11('0x44')](_0x2a5262),_0x2a5262[_0x4e11('0x4a')][_0x4e11('0x47')]['focus'](),this[_0x4e11('0x1f')](_0x2a5262)):this[_0x4e11('0x1f')](null);});};for(const _0x54d1d1 of _0x44be61)_0x41b600(_0x54d1d1);this[_0x4e11('0x40')](_0x44be61,_0x4e11('0x10'),(_0x343598,_0x41d012)=>{_0x41b600(_0x41d012);}),this['listenTo'](_0x44be61,_0x4e11('0x2e'),(_0x48ec88,_0x3d873f,_0x76abf7)=>{this[_0x4e11('0x27')][_0x4e11('0xe')](_0x3d873f)[_0x4e11('0x4b')](),this['_annotationToNarrowView'][_0x4e11('0x5')](_0x3d873f),_0x3e3b7e['rearrange']({'removedAnnotation':_0x3d873f,'previousAnnotation':_0x44be61[_0x4e11('0xe')](_0x76abf7-0x1),'nextAnnotation':_0x44be61['get'](_0x76abf7+0x1)}),_0x3d873f===this[_0x4e11('0x5a')]&&this[_0x4e11('0x1f')](null);},{'priority':_0x4e11('0x25')}),this['listenTo'](_0x44be61,_0x4e11('0x3'),(_0x12583c,_0x56e3de)=>{this[_0x4e11('0x1f')](_0x56e3de);}),this['listenTo'](_0x44be61,_0x4e11('0xf'),()=>{this[_0x4e11('0x1f')](null);}),this['_domEmitter'][_0x4e11('0x40')](document,_0x4e11('0x49'),(_0x574d4a,_0x184c5d)=>{_0x184c5d[_0x4e11('0x3b')]===_0x362211[_0x4e11('0x2f')]&&_0x2fc2fc[_0x4e11('0x12')]&&(this[_0x4e11('0x51')][_0x4e11('0x10')](_0x2fc2fc[_0x4e11('0x7')]['first']),this[_0x4e11('0x54')](),_0x184c5d[_0x4e11('0x58')](),_0x184c5d[_0x4e11('0x16')]());}),this['_domEmitter'][_0x4e11('0x40')](document,'mousedown',(_0x45cfba,_0x28bc51)=>{const _0x5580cd=_0x28bc51['target'];_0x2fc2fc[_0x4e11('0x12')]&&_0x2fc2fc['element'][_0x4e11('0x17')](_0x5580cd)||_0x3e3b7e['view'][_0x4e11('0x47')][_0x4e11('0x17')](_0x5580cd)||_0x45cfba[_0x4e11('0x23')]||this[_0x4e11('0x5a')]&&this['activeAnnotation'][_0x4e11('0x18')][_0x4e11('0x46')](_0x3b393a=>_0x3b393a['contains'](_0x5580cd))||(this['_manuallyClosedAnnotationViews'][_0x4e11('0x3e')](),this[_0x4e11('0x54')](),this[_0x4e11('0x1f')](null));});const _0x45b12a=this['context']instanceof _0x360811?this[_0x4e11('0x35')]['editors']:new _0x21be6e([this[_0x4e11('0x35')]]);for(const _0x3d75a9 of _0x45b12a)this[_0x4e11('0x2a')](_0x3d75a9);this[_0x4e11('0x40')](_0x45b12a,_0x4e11('0x10'),(_0x523c65,_0x853599)=>{this[_0x4e11('0x40')](_0x853599,'ready',()=>{this[_0x4e11('0x2a')](_0x853599);});}),this[_0x4e11('0x40')](_0x45b12a,'remove',(_0x17804f,_0x2d8c28)=>{_0x2d8c28[_0x4e11('0x3c')][_0x4e11('0x56')](_0x4e11('0x59'))&&this['_destroyEditorAnnotationsIntegration'](_0x2d8c28['plugins'][_0x4e11('0xe')](_0x4e11('0x59')));}),window['addEventListener'](_0x4e11('0x1c'),this[_0x4e11('0x2')]),this[_0x4e11('0x5b')]();}[_0x4e11('0x1f')](_0x5131c6){if(_0x5131c6===this[_0x4e11('0x5a')])return;const _0x3907e1=this['context']['plugins']['get'](_0x525883);if(_0x3907e1[_0x4e11('0x28')]({'blurredAnnotation':this[_0x4e11('0x5a')],'activatedAnnotation':_0x5131c6,'disableAnimationOnActivatedAnnotation':!0x0}),_0x5131c6)_0x3907e1['getSidebarItemView'](_0x5131c6)?this[_0x4e11('0x44')](_0x5131c6):this[_0x4e11('0x54')]();else this[_0x4e11('0x54')]();this[_0x4e11('0x5a')]=_0x5131c6;}[_0x4e11('0x22')](){if(!this[_0x4e11('0x48')])throw new _0x46865d(_0x4e11('0x9'),this);this['setActiveAnnotation'](null);const _0x1791e7=this['context']['plugins'][_0x4e11('0xe')](_0x525883);this['_hideBalloon'](),Array[_0x4e11('0x20')](this['_annotationToNarrowView'][_0x4e11('0x57')](),_0xb8c9c3=>_0xb8c9c3[_0x4e11('0x4b')]()),this['_annotationToNarrowView'][_0x4e11('0x3e')](),_0x1791e7['_detachFromContainer'](this[_0x4e11('0x3f')]),this['stopListening'](),this[_0x4e11('0x2c')][_0x4e11('0x3d')](),this[_0x4e11('0x35')]instanceof _0x360811&&this[_0x4e11('0x3d')](this[_0x4e11('0x35')]['editors']);for(const _0x4b1920 of Array[_0x4e11('0x20')](this[_0x4e11('0x8')]))this['_destroyEditorAnnotationsIntegration'](_0x4b1920);window['removeEventListener'](_0x4e11('0x1c'),this[_0x4e11('0x2')]),this['_refreshPositioningDebounced'][_0x4e11('0x34')](),this[_0x4e11('0x43')]=[],this['isAttached']=!0x1,this['annotations']=null;}[_0x4e11('0x4b')](){this[_0x4e11('0x48')]&&this[_0x4e11('0x22')](),this[_0x4e11('0x3a')][_0x4e11('0xa')]();}['_integrateWithEditorAnnotations'](_0xe1be85){const _0x50d279=_0xe1be85[_0x4e11('0x3c')][_0x4e11('0xe')](_0xe0d9e5),_0x1ab4af=this[_0x4e11('0x35')][_0x4e11('0x3c')][_0x4e11('0xe')](_0x525883),_0x20b889=this[_0x4e11('0x3f')],_0x1e8d05=this[_0x4e11('0xb')],_0x175c91=()=>{const _0x3e1572=_0x50d279['getOrderedSelectedAnnotations']({'annotations':this[_0x4e11('0x3f')],'activeAnnotation':this['activeAnnotation']});this[_0x4e11('0x1a')](_0x3e1572),this['setActiveAnnotation'](_0x3e1572[0x0]||null);};this[_0x4e11('0x40')](_0x50d279,_0x4e11('0x28'),_0x175c91),this[_0x4e11('0x40')](_0x50d279,_0x4e11('0xf'),(_0x29faab,{isAnnotationTracked:_0x37a90c})=>{this[_0x4e11('0x5a')]&&_0x37a90c(this['activeAnnotation'])&&(this[_0x4e11('0x1a')]([]),this[_0x4e11('0x1f')](null));}),this[_0x4e11('0x40')](_0x50d279,_0x4e11('0x24'),()=>{this['_refreshPositioningDebounced']();}),this['listenTo'](_0x20b889,_0x4e11('0xf'),_0xe0d005=>{_0x50d279[_0x4e11('0x1')]()&&_0xe0d005[_0x4e11('0x41')]();},{'priority':_0x4e11('0x1d')}),this[_0x4e11('0x40')](this['_domEmitter'],_0x4e11('0xd'),(_0x336488,_0x5b280a)=>{const _0x59829f=_0x5b280a[_0x4e11('0x21')];_0x1e8d05['isVisible']&&_0x1e8d05[_0x4e11('0x47')][_0x4e11('0x17')](_0x59829f)||_0x1ab4af[_0x4e11('0x4a')][_0x4e11('0x47')][_0x4e11('0x17')](_0x59829f)||this[_0x4e11('0x5a')]&&_0x50d279[_0x4e11('0x1')]()&&(_0x175c91(),_0x336488['preventClosingBalloon']=!0x0);},{'priority':_0x4e11('0x1d')}),this[_0x4e11('0x8')][_0x4e11('0x10')](_0x50d279);}[_0x4e11('0x36')](_0x58a322){_0x58a322&&(this[_0x4e11('0x3d')](_0x58a322),this[_0x4e11('0x8')][_0x4e11('0x2e')](_0x58a322));}[_0x4e11('0x1a')](_0x4b0ed1){for(const _0x36362c of this[_0x4e11('0x43')])_0x4b0ed1['includes'](_0x36362c)||this['_manuallyClosedAnnotationViews'][_0x4e11('0x5')](_0x36362c[_0x4e11('0x4a')]);this[_0x4e11('0x43')]=_0x4b0ed1;}[_0x4e11('0x5b')](){const _0x2299bb=this[_0x4e11('0xb')];this[_0x4e11('0x3f')][_0x4e11('0x53')](),_0x2299bb[_0x4e11('0x12')]&&this[_0x4e11('0x19')]();}['_showBalloon'](_0x523982){if(this['_manuallyClosedAnnotationViews'][_0x4e11('0x56')](_0x523982[_0x4e11('0x4a')]))return;const _0x5eb3e6=this['balloonPanelView'][_0x4e11('0x7')][_0x4e11('0x39')];_0x5eb3e6!==_0x523982[_0x4e11('0x4a')]?(_0x5eb3e6&&this[_0x4e11('0x32')](_0x5eb3e6),this[_0x4e11('0x1e')](_0x523982[_0x4e11('0x4a')]),this[_0x4e11('0xb')][_0x4e11('0x7')][_0x4e11('0x3e')](),this[_0x4e11('0xb')][_0x4e11('0x7')][_0x4e11('0x10')](_0x523982[_0x4e11('0x4a')]),this[_0x4e11('0x19')]()):this[_0x4e11('0x19')]();}['_updateBalloonPosition'](){const _0x12cd67=this['balloonPanelView'][_0x4e11('0x7')][_0x4e11('0x39')],_0x5a51bb=_0x12cd67&&this[_0x4e11('0x3f')]['getByView'](_0x12cd67);if(!_0x5a51bb||!this[_0x4e11('0x27')][_0x4e11('0x56')](_0x5a51bb))return;const _0x4aaa93=this[_0x4e11('0x27')]['get'](_0x5a51bb)[_0x4e11('0x47')],_0x5b6f68=function(){const _0x196fe2=_0x35ae86[_0x4e11('0x14')];return[_0x196fe2[_0x4e11('0x30')],_0x196fe2[_0x4e11('0x52')],_0x196fe2[_0x4e11('0x29')],_0x196fe2['northArrowSouth'],_0x196fe2[_0x4e11('0x42')],_0x196fe2['northArrowSouthWest']];}();this['balloonPanelView']['pin']({'target':_0x4aaa93,'positions':_0x5b6f68});}['_hideBalloon'](){const _0x38116a=this[_0x4e11('0xb')],_0x7f9772=_0x38116a[_0x4e11('0x7')][_0x4e11('0x39')];_0x7f9772&&(this[_0x4e11('0x32')](_0x7f9772),_0x38116a['unpin'](),_0x38116a[_0x4e11('0x7')][_0x4e11('0x3e')]());}[_0x4e11('0x1e')](_0x50e122){this['listenTo'](_0x50e122,_0x4e11('0x4'),()=>this[_0x4e11('0x19')]()),this[_0x4e11('0x40')](_0x50e122,_0x4e11('0x6'),(_0x4c10cf,_0x5c9bc9)=>{this[_0x4e11('0x51')]['add'](_0x50e122),this[_0x4e11('0x54')](),_0x5c9bc9();});}[_0x4e11('0x32')](_0x2e38fe){this[_0x4e11('0x3d')](_0x2e38fe);}}