/*
 *             Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x5d8e=['push','get','_removeActiveAnnotation','annotationsuis-missing-ui','activeAnnotations','context','from','_addActiveAnnotation','function','refilterAnnotations','annotationsuis-register-invalid-interface','deactivate','deactivateAll','_uis','detach','_uisData','size','change:activeAnnotation','length','_assertAnnotationDoesNotBelongToMultipleUIs','setActiveAnnotation','annotationsuis-register-already-registered','_visibleAnnotations','isActive','attach','listenTo','collection','delete','activeUIs','filter','has','plugins','_setSelectedAnnotations','switchTo','set','register','_activateAnnotation','annotationsuis-annotation-mismatch','destroy','add','AnnotationsUIs','activate'];(function(_0xd4d5c2,_0x5d8e17){const _0x179655=function(_0x281a22){while(--_0x281a22){_0xd4d5c2['push'](_0xd4d5c2['shift']());}};_0x179655(++_0x5d8e17);}(_0x5d8e,0x9b));const _0x1796=function(_0xd4d5c2,_0x5d8e17){_0xd4d5c2=_0xd4d5c2-0x0;let _0x179655=_0x5d8e[_0xd4d5c2];return _0x179655;};import{ContextPlugin as _0x3ce081}from'ckeditor5/src/core';import{CKEditorError as _0x36e025}from'ckeditor5/src/utils';import _0x1d995f,{bindAnnotationCollections as _0x5a7ddb}from'./annotationcollection';import _0x28ad51 from'./annotations';export default class M extends _0x3ce081{static get['requires'](){return[_0x28ad51];}static get['pluginName'](){return _0x1796('0xb');}constructor(_0x5cf027){super(_0x5cf027),this[_0x1796('0x29')]=new Set(),this['_uis']=new Map(),this[_0x1796('0x1c')]=new Map();}['init'](){const _0x3cc2d8=this['context']['plugins'][_0x1796('0xe')](_0x28ad51);this[_0x1796('0x26')](_0x3cc2d8,_0x1796('0x7'),(_0x4ee690,_0x1964f6)=>{for(const _0x22e83c of this[_0x1796('0x29')]){const _0x4fd267=this[_0x1796('0x1a')]['get'](_0x22e83c);(0x0,this[_0x1796('0x1c')][_0x1796('0xe')](_0x22e83c)[_0x1796('0x0')])(_0x1964f6)&&_0x4fd267[_0x1796('0x21')](_0x1964f6);}}),this[_0x1796('0x26')](_0x3cc2d8,'_deactivateAllAnnotations',()=>{for(const _0x2637c5 of this['activeUIs']){this[_0x1796('0x1a')][_0x1796('0xe')](_0x2637c5)[_0x1796('0x21')](null);}}),this[_0x1796('0x26')](_0x3cc2d8[_0x1796('0x23')],_0x1796('0xa'),(_0x8d4f3b,_0x347311)=>{this[_0x1796('0x20')](_0x347311);});}['hasActive'](){return this[_0x1796('0x29')][_0x1796('0x1d')]>0x0;}[_0x1796('0x24')](_0x17233f){return this[_0x1796('0x29')][_0x1796('0x1')](_0x17233f);}[_0x1796('0xc')](_0x101f96,_0xa749bb=()=>!0x0){const _0x4eb829=this[_0x1796('0x12')]['plugins'][_0x1796('0xe')](_0x28ad51);if(!this[_0x1796('0x1a')][_0x1796('0x1')](_0x101f96))throw new _0x36e025('annotationsuis-missing-ui',this,{'uiName':_0x101f96});this[_0x1796('0x24')](_0x101f96)&&this[_0x1796('0x18')](_0x101f96),this[_0x1796('0x29')]['add'](_0x101f96);const _0x3293a2=new _0x1d995f(),_0x292b7a=_0x4eb829[_0x1796('0x23')];_0x5a7ddb({'source':_0x292b7a,'target':_0x3293a2,'filter':_0xa749bb}),this[_0x1796('0x1c')][_0x1796('0x5')](_0x101f96,{'collection':_0x3293a2,'filter':_0xa749bb});const _0x469d20=this[_0x1796('0x1a')][_0x1796('0xe')](_0x101f96);_0x469d20[_0x1796('0x25')](_0x3293a2),this[_0x1796('0x26')](_0x469d20,_0x1796('0x1e'),(_0x14519a,_0x39fc9f,_0x2b26ac,_0x5db4fa)=>{_0x5db4fa&&_0x4eb829[_0x1796('0xf')](_0x5db4fa),_0x2b26ac&&_0x4eb829[_0x1796('0x14')](_0x2b26ac);});}[_0x1796('0x18')](_0x55ce40){if(this[_0x1796('0x29')][_0x1796('0x28')](_0x55ce40),!this['_uis'][_0x1796('0x1')](_0x55ce40))throw new _0x36e025(_0x1796('0x10'),this,{'uiName':_0x55ce40});const _0x12aa6f=this['_uis'][_0x1796('0xe')](_0x55ce40);_0x12aa6f[_0x1796('0x1b')](),this['stopListening'](_0x12aa6f),this[_0x1796('0x1c')][_0x1796('0xe')](_0x55ce40)[_0x1796('0x27')]['destroy'](),this[_0x1796('0x1c')][_0x1796('0x28')](_0x55ce40);}[_0x1796('0x4')](_0x507e12){if(!this['_uis'][_0x1796('0x1')](_0x507e12))throw new _0x36e025(_0x1796('0x10'),this,{'uiName':_0x507e12});const _0x45f7df=this[_0x1796('0x12')][_0x1796('0x2')]['get'](_0x28ad51),_0x2112f1=Array['from'](_0x45f7df[_0x1796('0x11')])[0x0]||null;this[_0x1796('0x19')](),this['activate'](_0x507e12);const _0xd658d6=this[_0x1796('0x1a')][_0x1796('0xe')](_0x507e12);_0xd658d6[_0x1796('0x21')](_0x2112f1),_0xd658d6['_setSelectedAnnotations']&&_0x2112f1&&_0xd658d6[_0x1796('0x3')]([_0x2112f1]);}[_0x1796('0x19')](){for(const _0x2019e0 of this[_0x1796('0x29')])this[_0x1796('0x18')](_0x2019e0);}[_0x1796('0x6')](_0x4b040f,_0x1e526d){if(this[_0x1796('0x1a')][_0x1796('0x1')](_0x4b040f))throw new _0x36e025(_0x1796('0x22'));if(_0x1796('0x15')!=typeof _0x1e526d[_0x1796('0x25')]||_0x1796('0x15')!=typeof _0x1e526d[_0x1796('0x1b')]||_0x1796('0x15')!=typeof _0x1e526d[_0x1796('0x21')])throw new _0x36e025(_0x1796('0x17'),null);this[_0x1796('0x1a')]['set'](_0x4b040f,_0x1e526d);}[_0x1796('0x16')](){const _0x172430=this[_0x1796('0x12')][_0x1796('0x2')][_0x1796('0xe')](_0x28ad51)[_0x1796('0x27')],_0x53c910=new Map(),_0xaeb4fd=Array[_0x1796('0x13')](this[_0x1796('0x29')]);for(const _0x4fa98c of this[_0x1796('0x29')]){const _0xb4b8c1=this['_uisData'][_0x1796('0xe')](_0x4fa98c)[_0x1796('0x27')];for(const _0x166eca of _0xb4b8c1)_0x53c910['set'](_0x166eca,_0x4fa98c);}for(const _0xa4caf3 of _0x172430){const _0x2b57e8=_0x53c910[_0x1796('0xe')](_0xa4caf3);this[_0x1796('0x20')](_0xa4caf3);const _0x40405d=_0xaeb4fd['find'](_0x415caa=>this[_0x1796('0x1c')][_0x1796('0xe')](_0x415caa)[_0x1796('0x0')](_0xa4caf3));_0x2b57e8!==_0x40405d&&(_0x2b57e8&&this[_0x1796('0x1c')]['get'](_0x2b57e8)[_0x1796('0x27')]['remove'](_0xa4caf3),_0x40405d&&this[_0x1796('0x1c')]['get'](_0x40405d)[_0x1796('0x27')][_0x1796('0xa')](_0xa4caf3));}}['destroy'](){this['deactivateAll'](),super[_0x1796('0x9')]();}[_0x1796('0x20')](_0x4f4a26){const _0x3dc0ba=[];for(const _0x24a0d8 of this[_0x1796('0x29')]){(0x0,this['_uisData']['get'](_0x24a0d8)[_0x1796('0x0')])(_0x4f4a26)&&_0x3dc0ba[_0x1796('0xd')](_0x24a0d8);}if(_0x3dc0ba[_0x1796('0x1f')]>0x1)throw new _0x36e025(_0x1796('0x8'),null,{'matchedUIs':_0x3dc0ba,'annotationType':_0x4f4a26['type']});}}